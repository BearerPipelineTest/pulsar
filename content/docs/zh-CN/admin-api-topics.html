<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Manage topics · Apache Pulsar</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&gt; **重要**"/><meta name="docsearch:version" content="2.9.1"/><meta name="docsearch:language" content="zh-CN"/><meta property="og:title" content="Manage topics · Apache Pulsar"/><meta property="og:type" content="website"/><meta property="og:url" content="https://pulsar.apache.org/"/><meta property="og:description" content="&gt; **重要**"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://pulsar.apache.org/img/pulsar.svg"/><link rel="shortcut icon" href="/img/pulsar.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="alternate" type="application/atom+xml" href="https://pulsar.apache.org/blog/atom.xml" title="Apache Pulsar Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://pulsar.apache.org/blog/feed.xml" title="Apache Pulsar Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-102219959-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code-blocks-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/custom.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/zh-CN"><img class="logo" src="/img/pulsar.svg" alt="Apache Pulsar"/></a><a href="/zh-CN/versions"><h3>2.9.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/zh-CN/standalone" target="_self">文档</a></li><li class=""><a href="/zh-CN/download" target="_self">下载</a></li><li class="siteNavGroupActive"><a href="/docs/zh-CN/client-libraries" target="_self">客户端</a></li><li class=""><a href="#restapis" target="_self">REST API</a></li><li class=""><a href="#cli" target="_self">命令行</a></li><li class=""><a href="/blog/" target="_self">博客</a></li><li class=""><a href="#community" target="_self">社区</a></li><li class=""><a href="#apache" target="_self">Apache</a></li><li class=""><a href="https://pulsar-next.staged.apache.org/" target="_self">New Website(Beta)</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/admin-api-topics">English</a></li><li><a href="/docs/ja/admin-api-topics">日本語</a></li><li><a href="/docs/fr/admin-api-topics">Français</a></li><li><a href="/docs/ko/admin-api-topics">한국어</a></li><li><a href="/docs/zh-TW/admin-api-topics">繁體中文</a></li><li><a href="https://crowdin.com/project/apache-pulsar" target="_blank" rel="noreferrer noopener">参与翻译</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Admin API</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Get Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/standalone">Run Pulsar locally</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/standalone-docker">Run Pulsar in Docker</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/kubernetes-helm">Run Pulsar in Kubernetes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">概念和架构</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-messaging">Messaging</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-architecture-overview">Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-clients">Clients</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-replication">Geo Replication</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-multi-tenancy">Multi Tenancy</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-authentication">Authentication and Authorization</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-topic-compaction">Topic Compaction</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-proxy-sni-routing">Proxy support with SNI routing</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-multiple-advertised-listeners">Multiple advertised listeners</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Pulsar Schema</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/schema-get-started">Get started</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/schema-understand">Understand schema</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/schema-evolution-compatibility">Schema evolution and compatibility</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/schema-manage">Manage schema</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Pulsar Functions</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/functions-overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/functions-runtime">Setup: Configure Functions runtime</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/functions-worker">Setup: Pulsar Functions Worker</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/functions-develop">How-to: Develop</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/functions-package">How-to: Package</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/functions-debug">How-to: Debug</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/functions-deploy">How-to: Deploy</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/functions-cli">Reference: CLI</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/window-functions-context">Window Functions: Context</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Pulsar IO</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/io-overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/io-quickstart">Get started</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/io-use">Use</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/io-debug">Debug</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/io-connectors">Built-in connector</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/io-cdc">CDC connector</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/io-develop">Develop</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/io-cli">CLI</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Pulsar SQL</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/sql-overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/sql-getting-started">Query data</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/sql-deployment-configurations">Configuration and deployment</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/sql-rest-api">REST APIs</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">层级存储</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/tiered-storage-overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/tiered-storage-aws">AWS S3 offloader</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/tiered-storage-gcs">GCS offloader</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/tiered-storage-filesystem">Filesystem offloader</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/tiered-storage-azure">Azure BlobStore offloader</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/tiered-storage-aliyun">Aliyun OSS offloader</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">事务</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/txn-why">Why transactions?</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/txn-what">What are transactions?</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/txn-how">How transactions work?</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/txn-use">How to use transactions?</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/txn-monitor">How to monitor transactions?</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Kubernetes (Helm)</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/helm-overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/helm-prepare">Prepare</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/helm-install">Install</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/helm-deploy">Deployment</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/helm-upgrade">Upgrade</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/helm-tools">Required Tools</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">部署</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/deploy-aws">Amazon Web Services</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/deploy-kubernetes">Kubernetes</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/deploy-bare-metal">Bare metal</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/deploy-bare-metal-multi-cluster">Bare metal multi-cluster</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/deploy-docker">Docker</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/deploy-monitoring">Monitor</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">系统管理</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/administration-zk-bk">ZooKeeper and BookKeeper</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/administration-geo">Geo-replication</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/administration-pulsar-manager">Pulsar Manager</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/administration-stats">Pulsar statistics</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/administration-load-balance">Load balance</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/administration-proxy">Pulsar proxy</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/administration-upgrade">Upgrade</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/administration-isolation">Pulsar isolation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">安全</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-tls-transport">Transport Encryption using TLS</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-tls-authentication">Authentication using TLS</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-tls-keystore">Using TLS with KeyStore configure</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-jwt">Authentication using JWT</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-athenz">Authentication using Athenz</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-kerberos">Authentication using Kerberos</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-oauth2">Authentication using OAuth 2.0 access tokens</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-authorization">Authorization and ACLs</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-encryption">End-to-End Encryption</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-extending">Extending</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/security-bouncy-castle">Bouncy Castle Providers</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">性能</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/performance-pulsar-perf">Pulsar Perf</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">客户端库</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/client-libraries">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/client-libraries-java">Java</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/client-libraries-go">Go</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/client-libraries-python">Python</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/client-libraries-cpp">C++</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/client-libraries-node">Node.js</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/client-libraries-websocket">WebSocket</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/client-libraries-dotnet">C#</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Admin API</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/admin-api-overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/admin-api-clusters">Clusters</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/admin-api-tenants">Tenants</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/admin-api-brokers">Brokers</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/admin-api-namespaces">Namespaces</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/admin-api-permissions">Permissions</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/zh-CN/admin-api-topics">Topics</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/admin-api-functions">Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/admin-api-packages">Packages</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">适配器</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/adaptors-kafka">Kafka client wrapper</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/adaptors-spark">Apache Spark</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/adaptors-storm">Apache Storm</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">参考手册</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/cookbooks-compaction">Topic compaction</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/cookbooks-deduplication">Message deduplication</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/cookbooks-non-persistent">Non-persistent messaging</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/cookbooks-retention-expiry">Message retention and expiry</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/cookbooks-encryption">Encryption</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/cookbooks-message-queue">Message queue</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/cookbooks-bookkeepermetadata">BookKeeper Ledger Metadata</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">开发</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/develop-tools">Simulation tools</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/develop-binary-protocol">Binary protocol</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/develop-schema">Custom schema storage</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/develop-load-manager">Modular load manager</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">参考</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-CN/reference-terminology">Terminology</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/reference-cli-tools">Pulsar CLI tools</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/reference-configuration">Pulsar configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/reference-metrics">Pulsar Metrics</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/apache-pulsar/zh-CN" target="_blank" rel="noreferrer noopener">Translate</a><h1 id="__docusaurus" class="postHeaderTitle">Manage topics</h1></header><article><div><span><blockquote>
<p><strong>重要</strong></p>
<p>此页面仅显示 <strong>部分常用操作</strong>。</p>
<ul>
<li><p>有关 <code>Pulsar admin</code> 的最新完整信息，包括命令、标志、描述等，请参阅 <a href="https://pulsar.apache.org/tools/pulsar-admin/">Pulsar admin 文档</a></p></li>
<li><p>关于 <code>REST API</code> 最新最完整的信息，包括参数、响应、示例等等，可参阅 <a href="https://pulsar.apache.org/admin-rest-api#/">REST</a>
 API 文档。</p></li>
<li><p>有关 <code>Java admin API</code> 的最新完整信息，包括类、方法、描述等，请参阅 <a href="https://pulsar.apache.org/api/admin/2.9.0-SNAPSHOT/"> Java admin API 文档</a>。</p></li>
</ul>
</blockquote>
<p>Pulsar 提供持久化与非持久化两种topic。 持久化topic是消息发布、消费的逻辑端点。 持久化主题地址的命名格式如下:</p>
<pre><code class="hljs css language-shell">persistent://tenant/namespace/topic
</code></pre>
<p>非持久主题应用在仅消费实时发布消息与不需要持久化保证的应用程序。 通过这种方式，它通过删除持久消息的开销来减少消息发布延迟。 非持久化topic地址的命名格式如下:</p>
<pre><code class="hljs css language-shell">non-persistent://tenant/namespace/topic
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="管理主题资源"></a><a href="#管理主题资源" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>管理主题资源</h2>
<p>无论是持久化还是非持久化主题，你可以通过<code>pulsar-admin</code>工具、REST API 、 Java 获取到主题资源。</p>
<blockquote>
<p><strong>备注</strong>    <br>
REST API 中 <code>:schema</code> 分为 persistent（持久化）和 non-persistent（非持久化）。 <code>:tenant</code>，<code>:namespace</code>，<code>:x</code> 是变量，在使用时候请注意使用真正的租户、命名空间，和 <code>x</code> 替换。<br>
以 <a href="https://pulsar.apache.org/admin-rest-api#operation/getList?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace</i></a>
 为例， 若要获取 REST API 中持久化主题列表，请参考 <code>https://pulsar.apache.org/admin/v2/persistent/my-tenant/my-namespace</code>。 若要获取 REST API 中非持久化主题的列表，请参考 <code>https://pulsar.apache.org/admin/v2/non-persistent/my-tenant/my-namespace</code>。</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="列出-topic"></a><a href="#列出-topic" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>列出 topic</h3>
<p>你可以通过以下方式获得特定命名空间下的 topic 列表。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34803-tab-34804" class="nav-link active" data-group="group_34803" data-tab="tab-group-34803-content-34804">pulsar-admin</div><div id="tab-group-34803-tab-34805" class="nav-link" data-group="group_34803" data-tab="tab-group-34803-content-34805">REST API</div><div id="tab-group-34803-tab-34806" class="nav-link" data-group="group_34803" data-tab="tab-group-34803-content-34806">Java</div></div><div class="tab-content"><div id="tab-group-34803-content-34804" class="tab-pane active" data-group="group_34803" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics list \</span><br />  my-tenant/my-namespace<br /></code></pre>
</span></div></div><div id="tab-group-34803-content-34805" class="tab-pane" data-group="group_34803" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getList?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace</i></a>
</p>
</span></div></div><div id="tab-group-34803-content-34806" class="tab-pane" data-group="group_34803" tabindex="-1"><div><span><pre><code class="hljs css language-java">String namespace = <span class="hljs-string">"my-tenant/my-namespace"</span>;<br />admin.topics().getList(namespace);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="授权"></a><a href="#授权" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>授权</h3>
<p>通过以下方式可以在客户端角色上授权，以便于在指定的主题上执行具体的操作。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34807-tab-34808" class="nav-link active" data-group="group_34807" data-tab="tab-group-34807-content-34808">pulsar-admin</div><div id="tab-group-34807-tab-34809" class="nav-link" data-group="group_34807" data-tab="tab-group-34807-content-34809">REST API</div><div id="tab-group-34807-tab-34810" class="nav-link" data-group="group_34807" data-tab="tab-group-34807-content-34810">Java</div></div><div class="tab-content"><div id="tab-group-34807-content-34808" class="tab-pane active" data-group="group_34807" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics grant-permission \</span><br />  --actions produce,consume --role application1 \<br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34807-content-34809" class="tab-pane" data-group="group_34807" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/grantPermissionsOnTopic?version=2.9.1&amp;apiVersion=v2"><b>POST</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/permissions/:role</i></a>
</p>
</span></div></div><div id="tab-group-34807-content-34810" class="tab-pane" data-group="group_34807" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />String role = <span class="hljs-string">"test-role"</span>;<br />Set&lt;AuthAction&gt; actions  = Sets.newHashSet(AuthAction.produce, AuthAction.consume);<br />admin.topics().grantPermission(topic, role, actions);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取权限"></a><a href="#获取权限" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取权限</h3>
<p>通过以下方式获取权限认证。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34811-tab-34812" class="nav-link active" data-group="group_34811" data-tab="tab-group-34811-content-34812">pulsar-admin</div><div id="tab-group-34811-tab-34813" class="nav-link" data-group="group_34811" data-tab="tab-group-34811-content-34813">REST API</div><div id="tab-group-34811-tab-34814" class="nav-link" data-group="group_34811" data-tab="tab-group-34811-content-34814">Java</div></div><div class="tab-content"><div id="tab-group-34811-content-34812" class="tab-pane active" data-group="group_34811" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics permissions \</span><br />  persistent://test-tenant/ns1/tp1 \<br /><br />{<br />    "application1": [<br />        "consume",<br />        "produce"<br />    ]<br />}<br /></code></pre>
</span></div></div><div id="tab-group-34811-content-34813" class="tab-pane" data-group="group_34811" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getPermissionsOnTopic?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/permissions</i></a>
</p>
</span></div></div><div id="tab-group-34811-content-34814" class="tab-pane" data-group="group_34811" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().getPermissions(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="取消权限"></a><a href="#取消权限" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>取消权限</h3>
<p>您可以通过以下方式撤销授予客户端角色的权限。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34815-tab-34816" class="nav-link active" data-group="group_34815" data-tab="tab-group-34815-content-34816">pulsar-admin</div><div id="tab-group-34815-tab-34817" class="nav-link" data-group="group_34815" data-tab="tab-group-34815-content-34817">REST API</div><div id="tab-group-34815-tab-34818" class="nav-link" data-group="group_34815" data-tab="tab-group-34815-content-34818">Java</div></div><div class="tab-content"><div id="tab-group-34815-content-34816" class="tab-pane active" data-group="group_34815" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics revoke-permission \</span><br />  --role application1 \<br />  persistent://test-tenant/ns1/tp1 \<br /><br />{<br />  "application1": [<br />    "consume",<br />    "produce"<br />  ]<br />}<br /></code></pre>
</span></div></div><div id="tab-group-34815-content-34817" class="tab-pane" data-group="group_34815" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/revokePermissionsOnTopic?version=2.9.1&amp;apiVersion=v2"><b>DELETE</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/permissions/:role</i></a>
</p>
</span></div></div><div id="tab-group-34815-content-34818" class="tab-pane" data-group="group_34815" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />String role = <span class="hljs-string">"test-role"</span>;<br />admin.topics().revokePermissions(topic, role);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="删除-topic"></a><a href="#删除-topic" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>删除 topic</h3>
<p>您可以通过以下方式删除一个主题。 如果某个主题拥有任何活跃的订阅或者生产者，则不能对其删除。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34819-tab-34820" class="nav-link active" data-group="group_34819" data-tab="tab-group-34819-content-34820">pulsar-admin</div><div id="tab-group-34819-tab-34821" class="nav-link" data-group="group_34819" data-tab="tab-group-34819-content-34821">REST API</div><div id="tab-group-34819-tab-34822" class="nav-link" data-group="group_34819" data-tab="tab-group-34819-content-34822">Java</div></div><div class="tab-content"><div id="tab-group-34819-content-34820" class="tab-pane active" data-group="group_34819" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics delete \</span><br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34819-content-34821" class="tab-pane" data-group="group_34819" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/deleteTopic?version=2.9.1&amp;apiVersion=v2"><b>DELETE</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic</i></a>
</p>
</span></div></div><div id="tab-group-34819-content-34822" class="tab-pane" data-group="group_34819" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().delete(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="卸载-topic"></a><a href="#卸载-topic" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>卸载 topic</h3>
<p>通过以下方式卸载主题。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34823-tab-34824" class="nav-link active" data-group="group_34823" data-tab="tab-group-34823-content-34824">pulsar-admin</div><div id="tab-group-34823-tab-34825" class="nav-link" data-group="group_34823" data-tab="tab-group-34823-content-34825">REST API</div><div id="tab-group-34823-tab-34826" class="nav-link" data-group="group_34823" data-tab="tab-group-34823-content-34826">Java</div></div><div class="tab-content"><div id="tab-group-34823-content-34824" class="tab-pane active" data-group="group_34823" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics unload \</span><br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34823-content-34825" class="tab-pane" data-group="group_34823" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/unloadTopic?version=2.9.1&amp;apiVersion=v2"><b>PUT</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/unload</i></a>
</p>
</span></div></div><div id="tab-group-34823-content-34826" class="tab-pane" data-group="group_34823" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().unload(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取统计信息"></a><a href="#获取统计信息" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取统计信息</h3>
<p>你可以检查给定的未分区主题的以下统计数据。</p>
<ul>
<li><p><strong>msgRateIn</strong>：所有本地和副本发布者每秒发布消息速率之和（msg/s）。</p></li>
<li><p><strong>msgThroughputIn</strong>：所有本地和副本发布者每秒发布消息字节数之和（byte/s）。</p></li>
<li><p><strong>msgRateOut</strong>：所有本地和副本消费者每秒调度消息率之和（msg/s）。</p></li>
<li><p><strong>msgThroughputOut</strong>：所有本地和副本消费者每秒调度消息字节数之和（byte/s）。</p></li>
<li><p><strong>averageMsgSize</strong>：在最近时间间隔内发布消息的平均大小（以字节为单位）。</p></li>
<li><p><strong>storageSize</strong>: The sum of the ledgers' storage size for this topic. 用于存储该主题消息的空间。</p></li>
<li><p><strong>bytesInCounter</strong>: Total bytes published to the topic.</p></li>
<li><p><strong>msgInCounter</strong>: Total messages published to the topic.</p></li>
<li><p><strong>bytesOutCounter</strong>: Total bytes delivered to consumers.</p></li>
<li><p><strong>msgOutCounter</strong>: Total messages delivered to consumers.</p></li>
<li><p><strong>msgChunkPublished</strong>: Topic has chunked message published on it.</p></li>
<li><p><strong>backlogSize</strong>: Estimated total unconsumed or backlog size (in bytes).</p></li>
<li><p><strong>offloadedStorageSize</strong>: Space used to store the offloaded messages for the topic (in bytes).</p></li>
<li><p><strong>waitingPublishers</strong>: The number of publishers waiting in a queue in exclusive access mode.</p></li>
<li><p><strong>deduplicationStatus</strong>: The status of message deduplication for the topic.</p></li>
<li><p><strong>topicEpoch</strong>: The topic epoch or empty if not set.</p></li>
<li><p><strong>nonContiguousDeletedMessagesRanges</strong>: The number of non-contiguous deleted messages ranges.</p></li>
<li><p><strong>nonContiguousDeletedMessagesRangesSerializedSize</strong>: The serialized size of non-contiguous deleted messages ranges.</p></li>
<li><p><strong>publishers</strong>: The list of all local publishers into the topic. 该列表的范围从零到千不等。</p>
<ul>
<li><p><strong>accessMode</strong>: The type of access to the topic that the producer requires.</p></li>
<li><p><strong>msgRateIn</strong>：发布者每秒发布消息的总速率（msg/s）。</p></li>
<li><p><strong>msgThroughputIn</strong>：发布者发布消息的总吞吐量（byte/s）。</p></li>
<li><p><strong>averageMsgSize</strong>：发布者在最近时间间隔内发布消息的平均大小（以字节为单位）。</p></li>
<li><p><strong>chunkedMessageRate</strong>: The total rate of chunked messages published by this publisher.</p></li>
<li><p><strong>producerId</strong>：该主题对应的生产者内部识别号。</p></li>
<li><p><strong>producerName</strong>：由客户端生成的生产者内部识别名称。</p></li>
<li><p><strong>address</strong>：连接生产者所需的 IP 地址和端口号。</p></li>
<li><p><strong>connectedSince</strong>：生产者上次创建或者重新连接时的时间戳。</p></li>
<li><p><strong>clientVersion</strong>: The client library version of this producer.</p></li>
<li><p><strong>metadata</strong>: Metadata (key/value strings) associated with this publisher.</p></li>
</ul></li>
<li><p><strong>subscriptions</strong>：该主题下的所有本地订阅列表。</p>
<ul>
<li><p><strong>my-subscription</strong>：当前订阅的订阅名称。 通过客户端去定义。</p>
<ul>
<li><p><strong>msgRateOut</strong>：在此订阅中发送消息的总速率（msg/s）。</p></li>
<li><p><strong>msgThroughputOut</strong>：在此订阅上发送消息的总吞吐量（byte/s）。</p></li>
<li><p><strong>msgBacklog</strong>：在此订阅上积压的消息数量。</p></li>
<li><p><strong>type</strong>：订阅类型。</p></li>
<li><p><strong>msgRateExpired</strong>：由于 TTL 的原因，消息被丢弃而不是发送到此订阅中的比例。</p></li>
<li><p><strong>lastExpireTimestamp</strong>：最后一条执行消息过期的时间戳。</p></li>
<li><p><strong>lastConsumedFlowTimestamp</strong>：收到的最后一条流量指令的时间戳。</p></li>
<li><p><strong>lastConsumedTimestamp</strong>：消费者所有已消费消息的最新时间戳。</p></li>
<li><p><strong>lastAckedTimestamp</strong>：消费者所有已被 ack 消息的最新时间戳</p></li>
<li><p><strong>bytesOutCounter</strong>: Total bytes delivered to consumer.</p></li>
<li><p><strong>msgOutCounter</strong>: Total messages delivered to consumer.</p></li>
<li><p><strong>msgRateRedeliver</strong>: Total rate of messages redelivered on this subscription (msg/s).</p></li>
<li><p><strong>chunkedMessageRate</strong>: Chunked message dispatch rate.</p></li>
<li><p><strong>backlogSize</strong>: Size of backlog for this subscription (in bytes).</p></li>
<li><p><strong>msgBacklogNoDelayed</strong>: Number of messages in the subscription backlog that do not contain the delay messages.</p></li>
<li><p><strong>blockedSubscriptionOnUnackedMsgs</strong>: Flag to verify if a subscription is blocked due to reaching threshold of unacked messages.</p></li>
<li><p><strong>msgDelayed</strong>: Number of delayed messages currently being tracked.</p></li>
<li><p><strong>unackedMessages</strong>: Number of unacknowledged messages for the subscription.</p></li>
<li><p><strong>activeConsumerName</strong>: The name of the consumer that is active for single active consumer subscriptions. For example, failover or exclusive.</p></li>
<li><p><strong>totalMsgExpired</strong>: Total messages expired on this subscription.</p></li>
<li><p><strong>lastMarkDeleteAdvancedTimestamp</strong>: Last MarkDelete position advanced timestamp.</p></li>
<li><p><strong>durable</strong>: Whether the subscription is durable or ephemeral (for example, from a reader).</p></li>
<li><p><strong>replicated</strong>: Mark that the subscription state is kept in sync across different regions.</p></li>
<li><p><strong>allowOutOfOrderDelivery</strong>: Whether out of order delivery is allowed on the Key_Shared subscription.</p></li>
<li><p><strong>keySharedMode</strong>: Whether the Key_Shared subscription mode is AUTO_SPLIT or STICKY.</p></li>
<li><p><strong>consumersAfterMarkDeletePosition</strong>: This is for Key_Shared subscription to get the recentJoinedConsumers in the Key_Shared subscription.</p></li>
<li><p><strong>nonContiguousDeletedMessagesRanges</strong>: The number of non-contiguous deleted messages ranges.</p></li>
<li><p><strong>nonContiguousDeletedMessagesRangesSerializedSize</strong>: The serialized size of non-contiguous deleted messages ranges.</p></li>
<li><p><strong>consumers</strong>：连接到此订阅的消费者列表。</p>
<ul>
<li><p><strong>msgRateOut</strong>：发送给消费者的消息总速率（msg/s）。</p></li>
<li><p><strong>msgThroughputOut</strong>: 发送给消费者的总吞吐量（byte/s）。</p></li>
<li><p><strong>consumerName</strong>：由客户端生成的消费者内部标识符。</p></li>
<li><p><strong>availablePermits</strong>：消费者在客户端库的监听队列中有空闲的消息数量。 <code>0</code> 意味着客户端库的队列已经满了，<code>receive()</code> 方法不会再接收消息。 非 0 值意味着该消费者可以接收消息。</p></li>
<li><p><strong>unackedMessages</strong>：消费者未确认消息的数量。</p></li>
<li><p><strong>blockedConsumerOnUnackedMsgs</strong>：验证消费者是否因达到未确认消息数的阀值而被阻塞。</p></li>
<li><p><strong>lastConsumedTimestamp</strong>：消费者最后一次读取消息的时间戳。</p></li>
<li><p><strong>lastAckedTimestamp</strong>：消费者最后一次确认消息的时间戳。</p></li>
<li><p><strong>address</strong>: The IP address and source port for the connection of this consumer.</p></li>
<li><p><strong>connectedSince</strong>: The timestamp when this consumer is created or reconnected last time.</p></li>
<li><p><strong>clientVersion</strong>: The client library version of this consumer.</p></li>
<li><p><strong>bytesOutCounter</strong>: Total bytes delivered to consumer.</p></li>
<li><p><strong>msgOutCounter</strong>: Total messages delivered to consumer.</p></li>
<li><p><strong>msgRateRedeliver</strong>: Total rate of messages redelivered by this consumer (msg/s).</p></li>
<li><p><strong>chunkedMessageRate</strong>: The total rate of chunked messages delivered to this consumer.</p></li>
<li><p><strong>avgMessagesPerEntry</strong>: Number of average messages per entry for the consumer consumed.</p></li>
<li><p><strong>readPositionWhenJoining</strong>: The read position of the cursor when the consumer joining.</p></li>
<li><p><strong>keyHashRanges</strong>: Hash ranges assigned to this consumer if is Key_Shared sub mode.</p></li>
<li><p><strong>metadata</strong>: Metadata (key/value strings) associated with this consumer.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>replication</strong>: This section gives the stats for cross-colo replication of this topic</p>
<ul>
<li><p><strong>msgRateIn</strong>：从远程集群中收到消息的总速率（msg/s）。</p></li>
<li><p><strong>msgThroughputIn</strong>：从远程集群中收到消息的总吞吐量（byte/s）。</p></li>
<li><p><strong>msgRateOut</strong>：发送给副本订阅的消息总速率（msg/s）。</p></li>
<li><p><strong>msgThroughputOut</strong>：发送给副本订阅的消息总吞吐量（byte/s）。</p></li>
<li><p><strong>msgRateExpired</strong>：过期消息的总速率（msg/s）。</p></li>
<li><p><strong>replicationBacklog</strong>：待复制到远程集群的消息数量。</p></li>
<li><p><strong>connected</strong>：验证外部副本连接器是否已经连接。</p></li>
<li><p><strong>replicationDelayInSeconds</strong>：如果连接是 <code>true</code> 的话，最早消息的已等待被发送的时长。</p></li>
<li><p><strong>inboundConnection</strong>：远程集群中的 broker 要连接到此 broker 的 IP 和端口。</p></li>
<li><p><strong>inboundConnectedSince</strong>: The TCP connection being used to publish messages to the remote cluster. 如果没有连接到本地发布者，一分钟后连接将自动关闭。</p></li>
<li><p><strong>outboundConnection</strong>：外部副本连接的地址。</p></li>
<li><p><strong>outboundConnectedSince</strong>：建立对外连接时的时间戳。</p></li>
</ul></li>
</ul>
<p>下面是主题状态的示例：</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"msgRateIn"</span> : <span class="hljs-number">0.0</span>,
  <span class="hljs-attr">"msgThroughputIn"</span> : <span class="hljs-number">0.0</span>,
  <span class="hljs-attr">"msgRateOut"</span> : <span class="hljs-number">0.0</span>,
  <span class="hljs-attr">"msgThroughputOut"</span> : <span class="hljs-number">0.0</span>,
  <span class="hljs-attr">"bytesInCounter"</span> : <span class="hljs-number">504</span>,
  <span class="hljs-attr">"msgInCounter"</span> : <span class="hljs-number">9</span>,
  <span class="hljs-attr">"bytesOutCounter"</span> : <span class="hljs-number">2296</span>,
  <span class="hljs-attr">"msgOutCounter"</span> : <span class="hljs-number">41</span>,
  <span class="hljs-attr">"averageMsgSize"</span> : <span class="hljs-number">0.0</span>,
  <span class="hljs-attr">"msgChunkPublished"</span> : <span class="hljs-literal">false</span>,
  <span class="hljs-attr">"storageSize"</span> : <span class="hljs-number">504</span>,
  <span class="hljs-attr">"backlogSize"</span> : <span class="hljs-number">0</span>,
  <span class="hljs-attr">"offloadedStorageSize"</span> : <span class="hljs-number">0</span>,
  <span class="hljs-attr">"publishers"</span> : [ {
    <span class="hljs-attr">"accessMode"</span> : <span class="hljs-string">"Shared"</span>,
    <span class="hljs-attr">"msgRateIn"</span> : <span class="hljs-number">0.0</span>,
    <span class="hljs-attr">"msgThroughputIn"</span> : <span class="hljs-number">0.0</span>,
    <span class="hljs-attr">"averageMsgSize"</span> : <span class="hljs-number">0.0</span>,
    <span class="hljs-attr">"chunkedMessageRate"</span> : <span class="hljs-number">0.0</span>,
    <span class="hljs-attr">"producerId"</span> : <span class="hljs-number">0</span>,
    <span class="hljs-attr">"metadata"</span> : { },
    <span class="hljs-attr">"address"</span> : <span class="hljs-string">"/127.0.0.1:65402"</span>,
    <span class="hljs-attr">"connectedSince"</span> : <span class="hljs-string">"2021-06-09T17:22:55.913+08:00"</span>,
    <span class="hljs-attr">"clientVersion"</span> : <span class="hljs-string">"2.9.0-SNAPSHOT"</span>,
    <span class="hljs-attr">"producerName"</span> : <span class="hljs-string">"standalone-1-0"</span>
  } ],
  <span class="hljs-attr">"waitingPublishers"</span> : <span class="hljs-number">0</span>,
  <span class="hljs-attr">"subscriptions"</span> : {
    <span class="hljs-attr">"sub-demo"</span> : {
      <span class="hljs-attr">"msgRateOut"</span> : <span class="hljs-number">0.0</span>,
      <span class="hljs-attr">"msgThroughputOut"</span> : <span class="hljs-number">0.0</span>,
      <span class="hljs-attr">"bytesOutCounter"</span> : <span class="hljs-number">2296</span>,
      <span class="hljs-attr">"msgOutCounter"</span> : <span class="hljs-number">41</span>,
      <span class="hljs-attr">"msgRateRedeliver"</span> : <span class="hljs-number">0.0</span>,
      <span class="hljs-attr">"chunkedMessageRate"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"msgBacklog"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"backlogSize"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"msgBacklogNoDelayed"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"blockedSubscriptionOnUnackedMsgs"</span> : <span class="hljs-literal">false</span>,
      <span class="hljs-attr">"msgDelayed"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"unackedMessages"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"type"</span> : <span class="hljs-string">"Exclusive"</span>,
      <span class="hljs-attr">"activeConsumerName"</span> : <span class="hljs-string">"20b81"</span>,
      <span class="hljs-attr">"msgRateExpired"</span> : <span class="hljs-number">0.0</span>,
      <span class="hljs-attr">"totalMsgExpired"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"lastExpireTimestamp"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"lastConsumedFlowTimestamp"</span> : <span class="hljs-number">1623230565356</span>,
      <span class="hljs-attr">"lastConsumedTimestamp"</span> : <span class="hljs-number">1623230583946</span>,
      <span class="hljs-attr">"lastAckedTimestamp"</span> : <span class="hljs-number">1623230584033</span>,
      <span class="hljs-attr">"lastMarkDeleteAdvancedTimestamp"</span> : <span class="hljs-number">1623230584033</span>,
      <span class="hljs-attr">"consumers"</span> : [ {
        <span class="hljs-attr">"msgRateOut"</span> : <span class="hljs-number">0.0</span>,
        <span class="hljs-attr">"msgThroughputOut"</span> : <span class="hljs-number">0.0</span>,
        <span class="hljs-attr">"bytesOutCounter"</span> : <span class="hljs-number">2296</span>,
        <span class="hljs-attr">"msgOutCounter"</span> : <span class="hljs-number">41</span>,
        <span class="hljs-attr">"msgRateRedeliver"</span> : <span class="hljs-number">0.0</span>,
        <span class="hljs-attr">"chunkedMessageRate"</span> : <span class="hljs-number">0.0</span>,
        <span class="hljs-attr">"consumerName"</span> : <span class="hljs-string">"20b81"</span>,
        <span class="hljs-attr">"availablePermits"</span> : <span class="hljs-number">959</span>,
        <span class="hljs-attr">"unackedMessages"</span> : <span class="hljs-number">0</span>,
        <span class="hljs-attr">"avgMessagesPerEntry"</span> : <span class="hljs-number">314</span>,
        <span class="hljs-attr">"blockedConsumerOnUnackedMsgs"</span> : <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"lastAckedTimestamp"</span> : <span class="hljs-number">1623230584033</span>,
        <span class="hljs-attr">"lastConsumedTimestamp"</span> : <span class="hljs-number">1623230583946</span>,
        <span class="hljs-attr">"metadata"</span> : { },
        <span class="hljs-attr">"address"</span> : <span class="hljs-string">"/127.0.0.1:65172"</span>,
        <span class="hljs-attr">"connectedSince"</span> : <span class="hljs-string">"2021-06-09T17:22:45.353+08:00"</span>,
        <span class="hljs-attr">"clientVersion"</span> : <span class="hljs-string">"2.9.0-SNAPSHOT"</span>
      } ],
      <span class="hljs-attr">"allowOutOfOrderDelivery"</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">"consumersAfterMarkDeletePosition"</span> : { },
      <span class="hljs-attr">"nonContiguousDeletedMessagesRanges"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"nonContiguousDeletedMessagesRangesSerializedSize"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"durable"</span> : <span class="hljs-literal">true</span>,
      <span class="hljs-attr">"replicated"</span> : <span class="hljs-literal">false</span>
    }
  },
  <span class="hljs-attr">"replication"</span> : { },
  <span class="hljs-attr">"deduplicationStatus"</span> : <span class="hljs-string">"Disabled"</span>,
  <span class="hljs-attr">"nonContiguousDeletedMessagesRanges"</span> : <span class="hljs-number">0</span>,
  <span class="hljs-attr">"nonContiguousDeletedMessagesRangesSerializedSize"</span> : <span class="hljs-number">0</span>
}
</code></pre>
<p>使用以下方式来获取一个主题的状态：</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34827-tab-34828" class="nav-link active" data-group="group_34827" data-tab="tab-group-34827-content-34828">pulsar-admin</div><div id="tab-group-34827-tab-34829" class="nav-link" data-group="group_34827" data-tab="tab-group-34827-content-34829">REST API</div><div id="tab-group-34827-tab-34830" class="nav-link" data-group="group_34827" data-tab="tab-group-34827-content-34830">Java</div></div><div class="tab-content"><div id="tab-group-34827-content-34828" class="tab-pane active" data-group="group_34827" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics stats \</span><br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34827-content-34829" class="tab-pane" data-group="group_34827" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getStats?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/stats</i></a>
</p>
</span></div></div><div id="tab-group-34827-content-34830" class="tab-pane" data-group="group_34827" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().getStats(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取内部统计信息"></a><a href="#获取内部统计信息" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取内部统计信息</h3>
<p>主题中的详细统计数据如下：</p>
<ul>
<li><p><strong>entriesAddedCounter</strong>：自此 broker 加载该主题以来发布的消息总量。</p></li>
<li><p><strong>numberOfEntries</strong>：追踪消息的总数。</p></li>
<li><p><strong>totalSize</strong>：消息的总存储大小（以字节为单位）。</p></li>
<li><p><strong>currentLedgerEntries</strong>：当前打开写入操作的 ledger 中，写入的消息总数。</p></li>
<li><p><strong>currentLedgerSize</strong>：当前打开写入操作的 ledger 中，写入的消息字节大小。</p></li>
<li><p><strong>lastLedgerCreatedTimestamp</strong>：最后一个 ledger 创建的时间。</p></li>
<li><p><strong>lastLedgerCreationFailureTimestamp:</strong> 最后一个 ledger 失败的时间。</p></li>
<li><p><strong>waitingCursorsCount</strong>：等待新消息发布并标记为 &quot;caught up&quot;的游标数量。</p></li>
<li><p><strong>pendingAddEntriesCount</strong>：完成（异步）写请求的消息数。</p></li>
<li><p><strong>lastConfirmedEntry</strong>：最后一条成功写入消息的 ledger:entryid。 如果 entryid 为 <code>-1</code>，即 ledger 是开启状态，但没有写入任何的 entry 。</p></li>
<li><p><strong>state</strong>: The state of this ledger for writing. <code>LedgerOpened</code> 意味着 ledger 是开启状态，可以保存已发布的消息。</p></li>
<li><p><strong>ledgers</strong>：主题中所保存消息的有序 ledger 列表。</p>
<ul>
<li><p><strong>ledgerId</strong>: 此 ledger 的 ID。</p></li>
<li><p><strong>entries</strong>：属于该 ledger 的 entry 总数。</p></li>
<li><p><strong>size</strong>：写入该 ledger 的消息大小（以字节为单位）。</p></li>
<li><p><strong>offloaded</strong>：该 ledger 是否已卸载。</p></li>
<li><p><strong>metadata</strong>: 该 ledger 的元数据。</p></li>
</ul></li>
<li><p><strong>schemaLedgers</strong>：该主题模式下所有 ledger 的有序列表。</p>
<ul>
<li><p><strong>ledgerId</strong>: 此 ledger 的 ID。</p></li>
<li><p><strong>entries</strong>：属于该 ledger 的 entry 总数。</p></li>
<li><p><strong>size</strong>：写入该 ledger 的消息大小（以字节为单位）。</p></li>
<li><p><strong>offloaded</strong>：该 ledger 是否已卸载。</p></li>
<li><p><strong>metadata</strong>: 该 ledger 的元数据。</p></li>
</ul></li>
<li><p><strong>compactedLedger</strong>: The ledgers holding un-acked messages after topic compaction.</p>
<ul>
<li><p><strong>ledgerId</strong>: 此 ledger 的 ID。</p></li>
<li><p><strong>entries</strong>：属于该 ledger 的 entry 总数。</p></li>
<li><p><strong>size</strong>：写入该 ledger 的消息大小（以字节为单位）。</p></li>
<li><p><strong>offloaded</strong>：该 ledger 是否已卸载。 The value is <code>false</code> for the compacted topic ledger.</p></li>
</ul></li>
<li><p><strong>cursors</strong>: The list of all cursors on this topic. Each subscription in the topic stats has a cursor.</p>
<ul>
<li><p><strong>markDeletePosition</strong>: All messages before the markDeletePosition are acknowledged by the subscriber.</p></li>
<li><p><strong>readPosition</strong>: The latest position of subscriber for reading message.</p></li>
<li><p><strong>waitingReadOp</strong>: This is true when the subscription has read the latest message published to the topic and is waiting for new messages to be published.</p></li>
<li><p><strong>pendingReadOps</strong>: The counter for how many outstanding read requests to the BookKeepers in progress.</p></li>
<li><p><strong>messagesConsumedCounter</strong>: The number of messages this cursor has acked since this broker loaded this topic.</p></li>
<li><p><strong>cursorLedger</strong>: The ledger being used to persistently store the current markDeletePosition.</p></li>
<li><p><strong>cursorLedgerLastEntry</strong>: The last entryid used to persistently store the current markDeletePosition.</p></li>
<li><p><strong>individuallyDeletedMessages</strong>: If acknowledges are being done out of order, the ranges of messages acknowledged between the markDeletePosition and the read-position shows.</p></li>
<li><p><strong>lastLedgerSwitchTimestamp</strong>: The last time the cursor ledger is rolled over.</p></li>
<li><p><strong>state</strong>: The state of the cursor ledger: <code>Open</code> means you have a cursor ledger for saving updates of the markDeletePosition.</p></li>
</ul></li>
</ul>
<p>下面是关于一个主题的详细统计示例。</p>
<pre><code class="hljs css language-json">{
    <span class="hljs-attr">"entriesAddedCounter"</span>:<span class="hljs-number">0</span>,
    <span class="hljs-attr">"numberOfEntries"</span>:<span class="hljs-number">0</span>,
    <span class="hljs-attr">"totalSize"</span>:<span class="hljs-number">0</span>,
    <span class="hljs-attr">"currentLedgerEntries"</span>:<span class="hljs-number">0</span>,
    <span class="hljs-attr">"currentLedgerSize"</span>:<span class="hljs-number">0</span>,
    <span class="hljs-attr">"lastLedgerCreatedTimestamp"</span>:<span class="hljs-string">"2021-01-22T21:12:14.868+08:00"</span>,
    <span class="hljs-attr">"lastLedgerCreationFailureTimestamp"</span>:<span class="hljs-literal">null</span>,
    <span class="hljs-attr">"waitingCursorsCount"</span>:<span class="hljs-number">0</span>,
    <span class="hljs-attr">"pendingAddEntriesCount"</span>:<span class="hljs-number">0</span>,
    <span class="hljs-attr">"lastConfirmedEntry"</span>:<span class="hljs-string">"3:-1"</span>,
    <span class="hljs-attr">"state"</span>:<span class="hljs-string">"LedgerOpened"</span>,
    <span class="hljs-attr">"ledgers"</span>:[
        {
            <span class="hljs-attr">"ledgerId"</span>:<span class="hljs-number">3</span>,
            <span class="hljs-attr">"entries"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"size"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"offloaded"</span>:<span class="hljs-literal">false</span>,
            <span class="hljs-attr">"metadata"</span>:<span class="hljs-literal">null</span>
        }
    ],
    <span class="hljs-attr">"cursors"</span>:{
        <span class="hljs-attr">"test"</span>:{
            <span class="hljs-attr">"markDeletePosition"</span>:<span class="hljs-string">"3:-1"</span>,
            <span class="hljs-attr">"readPosition"</span>:<span class="hljs-string">"3:-1"</span>,
            <span class="hljs-attr">"waitingReadOp"</span>:<span class="hljs-literal">false</span>,
            <span class="hljs-attr">"pendingReadOps"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"messagesConsumedCounter"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"cursorLedger"</span>:<span class="hljs-number">4</span>,
            <span class="hljs-attr">"cursorLedgerLastEntry"</span>:<span class="hljs-number">1</span>,
            <span class="hljs-attr">"individuallyDeletedMessages"</span>:<span class="hljs-string">"[]"</span>,
            <span class="hljs-attr">"lastLedgerSwitchTimestamp"</span>:<span class="hljs-string">"2021-01-22T21:12:14.966+08:00"</span>,
            <span class="hljs-attr">"state"</span>:<span class="hljs-string">"Open"</span>,
            <span class="hljs-attr">"numberOfEntriesSinceFirstNotAckedMessage"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"totalNonContiguousDeletedMessagesRange"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"properties"</span>:{

            }
        }
    },
    <span class="hljs-attr">"schemaLedgers"</span>:[
        {
            <span class="hljs-attr">"ledgerId"</span>:<span class="hljs-number">1</span>,
            <span class="hljs-attr">"entries"</span>:<span class="hljs-number">11</span>,
            <span class="hljs-attr">"size"</span>:<span class="hljs-number">10</span>,
            <span class="hljs-attr">"offloaded"</span>:<span class="hljs-literal">false</span>,
            <span class="hljs-attr">"metadata"</span>:<span class="hljs-literal">null</span>
        }
    ],
    <span class="hljs-attr">"compactedLedger"</span>:{
        <span class="hljs-attr">"ledgerId"</span>:<span class="hljs-number">-1</span>,
        <span class="hljs-attr">"entries"</span>:<span class="hljs-number">-1</span>,
        <span class="hljs-attr">"size"</span>:<span class="hljs-number">-1</span>,
        <span class="hljs-attr">"offloaded"</span>:<span class="hljs-literal">false</span>,
        <span class="hljs-attr">"metadata"</span>:<span class="hljs-literal">null</span>
    }
}
</code></pre>
<p>可以使用以下方式来获取一个主题的内部状态。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34831-tab-34832" class="nav-link active" data-group="group_34831" data-tab="tab-group-34831-content-34832">pulsar-admin</div><div id="tab-group-34831-tab-34833" class="nav-link" data-group="group_34831" data-tab="tab-group-34831-content-34833">REST API</div><div id="tab-group-34831-tab-34834" class="nav-link" data-group="group_34831" data-tab="tab-group-34831-content-34834">Java</div></div><div class="tab-content"><div id="tab-group-34831-content-34832" class="tab-pane active" data-group="group_34831" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics stats-internal \</span><br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34831-content-34833" class="tab-pane" data-group="group_34831" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getInternalStats?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/internalStats</i></a>
</p>
</span></div></div><div id="tab-group-34831-content-34834" class="tab-pane" data-group="group_34831" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().getInternalStats(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="查看消息"></a><a href="#查看消息" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>查看消息</h3>
<p>可以使用以下方式为某一主题的特定订阅提供一些信息。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34835-tab-34836" class="nav-link active" data-group="group_34835" data-tab="tab-group-34835-content-34836">pulsar-admin</div><div id="tab-group-34835-tab-34837" class="nav-link" data-group="group_34835" data-tab="tab-group-34835-content-34837">REST API</div><div id="tab-group-34835-tab-34838" class="nav-link" data-group="group_34835" data-tab="tab-group-34835-content-34838">Java</div></div><div class="tab-content"><div id="tab-group-34835-content-34836" class="tab-pane active" data-group="group_34835" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics peek-messages \</span><br />  --count 10 --subscription my-subscription \<br />  persistent://test-tenant/ns1/tp1 \<br /><br />Message ID: 315674752:0<br />Properties:  {  "X-Pulsar-publish-time" : "2015-07-13 17:40:28.451"  }<br />msg-payload<br /></code></pre>
</span></div></div><div id="tab-group-34835-content-34837" class="tab-pane" data-group="group_34835" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation?version=2.9.1/peekNthMessage&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/subscription/:subName/position/:messagePosition</i></a>
</p>
</span></div></div><div id="tab-group-34835-content-34838" class="tab-pane" data-group="group_34835" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />String subName = <span class="hljs-string">"my-subscription"</span>;<br /><span class="hljs-keyword">int</span> numMessages = <span class="hljs-number">1</span>;<br />admin.topics().peekMessages(topic, subName, numMessages);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="get-message-by-id"></a><a href="#get-message-by-id" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get message by ID</h3>
<p>可以使用以下方式获取给定 ledger ID 和 entry ID 的信息。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34839-tab-34840" class="nav-link active" data-group="group_34839" data-tab="tab-group-34839-content-34840">pulsar-admin</div><div id="tab-group-34839-tab-34841" class="nav-link" data-group="group_34839" data-tab="tab-group-34839-content-34841">REST API</div><div id="tab-group-34839-tab-34842" class="nav-link" data-group="group_34839" data-tab="tab-group-34839-content-34842">Java</div></div><div class="tab-content"><div id="tab-group-34839-content-34840" class="tab-pane active" data-group="group_34839" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> ./bin/pulsar-admin topics get-message-by-id \</span><br />  persistent://public/default/my-topic \<br />  -l 10 -e 0<br /></code></pre>
</span></div></div><div id="tab-group-34839-content-34841" class="tab-pane" data-group="group_34839" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getMessageById?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/ledger/:ledgerId/entry/:entryId</i></a>
</p>
</span></div></div><div id="tab-group-34839-content-34842" class="tab-pane" data-group="group_34839" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br /><span class="hljs-keyword">long</span> ledgerId = <span class="hljs-number">10</span>;<br /><span class="hljs-keyword">long</span> entryId = <span class="hljs-number">10</span>;<br />admin.topics().getMessageById(topic, ledgerId, entryId);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="检查消息"></a><a href="#检查消息" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>检查消息</h3>
<p>您可以根据相对于最早或最新消息的位置来检查某个主题上的特定消息。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34843-tab-34844" class="nav-link active" data-group="group_34843" data-tab="tab-group-34843-content-34844">pulsar-admin</div><div id="tab-group-34843-tab-34845" class="nav-link" data-group="group_34843" data-tab="tab-group-34843-content-34845">REST API</div><div id="tab-group-34843-tab-34846" class="nav-link" data-group="group_34843" data-tab="tab-group-34843-content-34846">Java</div></div><div class="tab-content"><div id="tab-group-34843-content-34844" class="tab-pane active" data-group="group_34843" tabindex="-1"><div><span><pre><code class="hljs css language-shell">./bin/pulsar-admin topics examine-messages \<br />  persistent://public/default/my-topic \<br />  -i latest -m 1<br /></code></pre>
</span></div></div><div id="tab-group-34843-content-34845" class="tab-pane" data-group="group_34843" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/examineMessage?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/examinemessage?initialPosition=:initialPosition&amp;messagePosition=:messagePosition</i></a>
</p>
</span></div></div><div id="tab-group-34843-content-34846" class="tab-pane" data-group="group_34843" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().examineMessage(topic, <span class="hljs-string">"latest"</span>, <span class="hljs-number">1</span>);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="按-id-获取消息"></a><a href="#按-id-获取消息" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>按 ID 获取消息</h3>
<p>您可以获得在指定日期时间或日期时间之后发布的消息ID。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34847-tab-34848" class="nav-link active" data-group="group_34847" data-tab="tab-group-34847-content-34848">pulsar-admin</div><div id="tab-group-34847-tab-34849" class="nav-link" data-group="group_34847" data-tab="tab-group-34847-content-34849">REST API</div><div id="tab-group-34847-tab-34850" class="nav-link" data-group="group_34847" data-tab="tab-group-34847-content-34850">Java</div></div><div class="tab-content"><div id="tab-group-34847-content-34848" class="tab-pane active" data-group="group_34847" tabindex="-1"><div><span><pre><code class="hljs css language-shell">./bin/pulsar-admin topics get-message-id \<br />  persistent://public/default/my-topic \<br />  -d 2021-06-28T19:01:17Z<br /></code></pre>
</span></div></div><div id="tab-group-34847-content-34849" class="tab-pane" data-group="group_34847" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getMessageIdByTimestamp?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/messageid/:timestamp</i></a>
</p>
</span></div></div><div id="tab-group-34847-content-34850" class="tab-pane" data-group="group_34847" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br /><span class="hljs-keyword">long</span> timestamp = System.currentTimeMillis()<br />admin.topics().getMessageIdByTimestamp(topic, timestamp);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="跳过消息"></a><a href="#跳过消息" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>跳过消息</h3>
<p>可以使用以下方式跳过某一主题的特定订阅的一些信息。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34851-tab-34852" class="nav-link active" data-group="group_34851" data-tab="tab-group-34851-content-34852">pulsar-admin</div><div id="tab-group-34851-tab-34853" class="nav-link" data-group="group_34851" data-tab="tab-group-34851-content-34853">REST API</div><div id="tab-group-34851-tab-34854" class="nav-link" data-group="group_34851" data-tab="tab-group-34851-content-34854">Java</div></div><div class="tab-content"><div id="tab-group-34851-content-34852" class="tab-pane active" data-group="group_34851" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics skip \</span><br />  --count 10 --subscription my-subscription \<br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34851-content-34853" class="tab-pane" data-group="group_34851" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/skipMessages?version=2.9.1&amp;apiVersion=v2"><b>POST</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/subscription/:subName/skip/:numMessages</i></a>
</p>
</span></div></div><div id="tab-group-34851-content-34854" class="tab-pane" data-group="group_34851" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />String subName = <span class="hljs-string">"my-subscription"</span>;<br /><span class="hljs-keyword">int</span> numMessages = <span class="hljs-number">1</span>;<br />admin.topics().skipMessages(topic, subName, numMessages);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="跳过所有消息"></a><a href="#跳过所有消息" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>跳过所有消息</h3>
<p>跳过某一主题的特定订阅的所有旧消息。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34855-tab-34856" class="nav-link active" data-group="group_34855" data-tab="tab-group-34855-content-34856">pulsar-admin</div><div id="tab-group-34855-tab-34857" class="nav-link" data-group="group_34855" data-tab="tab-group-34855-content-34857">REST API</div><div id="tab-group-34855-tab-34858" class="nav-link" data-group="group_34855" data-tab="tab-group-34855-content-34858">Java</div></div><div class="tab-content"><div id="tab-group-34855-content-34856" class="tab-pane active" data-group="group_34855" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics skip-all \</span><br />  --subscription my-subscription \<br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34855-content-34857" class="tab-pane" data-group="group_34855" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/skipAllMessages?version=2.9.1&amp;apiVersion=v2"><b>POST</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/subscription/:subName/skip_all</i></a>
</p>
</span></div></div><div id="tab-group-34855-content-34858" class="tab-pane" data-group="group_34855" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />String subName = <span class="hljs-string">"my-subscription"</span>;<br />admin.topics().skipAllMessages(topic, subName);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="重置cursor"></a><a href="#重置cursor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>重置cursor</h3>
<p>可以将一个订阅的游标位置重新设置为 X 分钟前记录的位置。 实际上通过计算时间和X分钟之前的cursor位置，来重置回到那个位置。 你可以用下面方式重置 cursor。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34859-tab-34860" class="nav-link active" data-group="group_34859" data-tab="tab-group-34859-content-34860">pulsar-admin</div><div id="tab-group-34859-tab-34861" class="nav-link" data-group="group_34859" data-tab="tab-group-34859-content-34861">REST API</div><div id="tab-group-34859-tab-34862" class="nav-link" data-group="group_34859" data-tab="tab-group-34859-content-34862">Java</div></div><div class="tab-content"><div id="tab-group-34859-content-34860" class="tab-pane active" data-group="group_34859" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics reset-cursor \</span><br />  --subscription my-subscription --time 10 \<br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34859-content-34861" class="tab-pane" data-group="group_34859" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/resetCursor?version=2.9.1&amp;apiVersion=v2"><b>POST</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/subscription/:subName/resetcursor/:timestamp</i></a>
</p>
</span></div></div><div id="tab-group-34859-content-34862" class="tab-pane" data-group="group_34859" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />String subName = <span class="hljs-string">"my-subscription"</span>;<br /><span class="hljs-keyword">long</span> timestamp = <span class="hljs-number">2342343L</span>;<br />admin.topics().skipAllMessages(topic, subName, timestamp);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="查询topic"></a><a href="#查询topic" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>查询topic</h3>
<p>可以通过以下方式找到服务于特定主题的 broker URL。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34863-tab-34864" class="nav-link active" data-group="group_34863" data-tab="tab-group-34863-content-34864">pulsar-admin</div><div id="tab-group-34863-tab-34865" class="nav-link" data-group="group_34863" data-tab="tab-group-34863-content-34865">REST API</div><div id="tab-group-34863-tab-34866" class="nav-link" data-group="group_34863" data-tab="tab-group-34863-content-34866">Java</div></div><div class="tab-content"><div id="tab-group-34863-content-34864" class="tab-pane active" data-group="group_34863" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics lookup \</span><br />  persistent://test-tenant/ns1/tp1 \<br /><br /> "pulsar://broker1.org.com:4480"<br /></code></pre>
</span></div></div><div id="tab-group-34863-content-34865" class="tab-pane" data-group="group_34863" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#/?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/lookup/v2/topic/:schema/:tenant:namespace/:topic</i></a>
</p>
</span></div></div><div id="tab-group-34863-content-34866" class="tab-pane" data-group="group_34863" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.lookup().lookupDestination(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取bundle"></a><a href="#获取bundle" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取bundle</h3>
<p>可以通过以下方式检查包含给定主题的 bundle 范围。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34867-tab-34868" class="nav-link active" data-group="group_34867" data-tab="tab-group-34867-content-34868">pulsar-admin</div><div id="tab-group-34867-tab-34869" class="nav-link" data-group="group_34867" data-tab="tab-group-34867-content-34869">REST API</div><div id="tab-group-34867-tab-34870" class="nav-link" data-group="group_34867" data-tab="tab-group-34867-content-34870">Java</div></div><div class="tab-content"><div id="tab-group-34867-content-34868" class="tab-pane active" data-group="group_34867" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics bundle-range \</span><br />  persistent://test-tenant/ns1/tp1 \<br /><br /> "0x00000000_0xffffffff"<br /></code></pre>
</span></div></div><div id="tab-group-34867-content-34869" class="tab-pane" data-group="group_34867" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#/?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/lookup/v2/topic/:topic_domain/:tenant/:namespace/:topic/bundle</i></a>
</p>
</span></div></div><div id="tab-group-34867-content-34870" class="tab-pane" data-group="group_34867" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.lookup().getBundleRange(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取订阅"></a><a href="#获取订阅" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取订阅</h3>
<p>可以通过以下方式查看某个主题的所有订阅名称。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34871-tab-34872" class="nav-link active" data-group="group_34871" data-tab="tab-group-34871-content-34872">pulsar-admin</div><div id="tab-group-34871-tab-34873" class="nav-link" data-group="group_34871" data-tab="tab-group-34871-content-34873">REST API</div><div id="tab-group-34871-tab-34874" class="nav-link" data-group="group_34871" data-tab="tab-group-34871-content-34874">Java</div></div><div class="tab-content"><div id="tab-group-34871-content-34872" class="tab-pane active" data-group="group_34871" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics subscriptions \</span><br />  persistent://test-tenant/ns1/tp1 \<br /><br /> my-subscription<br /></code></pre>
</span></div></div><div id="tab-group-34871-content-34873" class="tab-pane" data-group="group_34871" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getSubscriptions?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/subscriptions</i></a>
</p>
</span></div></div><div id="tab-group-34871-content-34874" class="tab-pane" data-group="group_34871" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().getSubscriptions(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="取消订阅"></a><a href="#取消订阅" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>取消订阅</h3>
<p>When a subscription does not process messages any more, you can unsubscribe it in the following ways.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34875-tab-34876" class="nav-link active" data-group="group_34875" data-tab="tab-group-34875-content-34876">pulsar-admin</div><div id="tab-group-34875-tab-34877" class="nav-link" data-group="group_34875" data-tab="tab-group-34875-content-34877">REST API</div><div id="tab-group-34875-tab-34878" class="nav-link" data-group="group_34875" data-tab="tab-group-34875-content-34878">Java</div></div><div class="tab-content"><div id="tab-group-34875-content-34876" class="tab-pane active" data-group="group_34875" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics unsubscribe \</span><br />  --subscription my-subscription \<br />  persistent://test-tenant/ns1/tp1 \<br /></code></pre>
</span></div></div><div id="tab-group-34875-content-34877" class="tab-pane" data-group="group_34875" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/deleteSubscription?version=2.9.1&amp;apiVersion=v2"><b>DELETE</b> <i>/admin/v2/namespaces/:tenant/:namespace/:topic/subscription/:subscription</i></a>
</p>
</span></div></div><div id="tab-group-34875-content-34878" class="tab-pane" data-group="group_34875" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />String subscriptionName = <span class="hljs-string">"my-subscription"</span>;<br />admin.topics().deleteSubscription(topic, subscriptionName);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="最后一条消息id"></a><a href="#最后一条消息id" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最后一条消息Id</h3>
<p>可以获得一个持久化主题最后提交的消息 ID 。 2.3.0 往后版本都可用。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34879-tab-34880" class="nav-link active" data-group="group_34879" data-tab="tab-group-34879-content-34880">pulsar-admin</div><div id="tab-group-34879-tab-34881" class="nav-link" data-group="group_34879" data-tab="tab-group-34879-content-34881">REST API</div><div id="tab-group-34879-tab-34882" class="nav-link" data-group="group_34879" data-tab="tab-group-34879-content-34882">Java</div></div><div class="tab-content"><div id="tab-group-34879-content-34880" class="tab-pane active" data-group="group_34879" tabindex="-1"><div><span><pre><code class="hljs css language-shell">pulsar-admin topics last-message-id topic-name<br /></code></pre>
</span></div></div><div id="tab-group-34879-content-34881" class="tab-pane" data-group="group_34879" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#/admin/v2/:schema/:tenant/:namespace/:topic/lastMessageId?version=2.9.1&amp;apiVersion=v2"><b>Get</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/lastMessageId?version=2.9.1</i></a>
</p>
</span></div></div><div id="tab-group-34879-content-34882" class="tab-pane" data-group="group_34879" tabindex="-1"><div><span><pre><code class="hljs css language-Java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().getLastMessage(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="配置去重快照间隔"></a><a href="#配置去重快照间隔" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>配置去重快照间隔</h3>
<h4><a class="anchor" aria-hidden="true" id="获取去重快照间隔"></a><a href="#获取去重快照间隔" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取去重快照间隔</h4>
<p>To get the topic-level deduplication snapshot interval, use one of the following methods.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34883-tab-34884" class="nav-link active" data-group="group_34883" data-tab="tab-group-34883-content-34884">Pulsar-admin API</div><div id="tab-group-34883-tab-34885" class="nav-link" data-group="group_34883" data-tab="tab-group-34883-content-34885">REST API</div><div id="tab-group-34883-tab-34886" class="nav-link" data-group="group_34883" data-tab="tab-group-34883-content-34886">Java API</div></div><div class="tab-content"><div id="tab-group-34883-content-34884" class="tab-pane active" data-group="group_34883" tabindex="-1"><div><span><pre><code class="hljs"><span class="hljs-string">pulsar-admin </span><span class="hljs-string">topics </span><span class="hljs-built_in">get-deduplication-snapshot-interval</span> <span class="hljs-string">options<br /></span></code></pre>
</span></div></div><div id="tab-group-34883-content-34885" class="tab-pane" data-group="group_34883" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|GET|/admin/v2/topics/:tenant/:namespace/:topic/deduplicationSnapshotInterval?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
</span></div></div><div id="tab-group-34883-content-34886" class="tab-pane" data-group="group_34883" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().getDeduplicationSnapshotInterval(topic)<br /></code></pre>
</span></div></div></div></div>
<h4><a class="anchor" aria-hidden="true" id="设置去重快照间隔"></a><a href="#设置去重快照间隔" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>设置去重快照间隔</h4>
<p>To set the topic-level deduplication snapshot interval, use one of the following methods.</p>
<blockquote>
<p><strong>Prerequisite</strong> <code>brokerDeduplicationEnabled</code> must be set to <code>true</code>.</p>
</blockquote>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34887-tab-34888" class="nav-link active" data-group="group_34887" data-tab="tab-group-34887-content-34888">Pulsar-admin API</div><div id="tab-group-34887-tab-34889" class="nav-link" data-group="group_34887" data-tab="tab-group-34887-content-34889">REST API</div><div id="tab-group-34887-tab-34890" class="nav-link" data-group="group_34887" data-tab="tab-group-34887-content-34890">Java API</div></div><div class="tab-content"><div id="tab-group-34887-content-34888" class="tab-pane active" data-group="group_34887" tabindex="-1"><div><span><pre><code class="hljs"><span class="hljs-string">pulsar-admin </span><span class="hljs-string">topics </span><span class="hljs-built_in">set-deduplication-snapshot-interval</span> <span class="hljs-string">options </span><br /></code></pre>
</span></div></div><div id="tab-group-34887-content-34889" class="tab-pane" data-group="group_34887" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|POST|/admin/v2/topics/:tenant/:namespace/:topic/deduplicationSnapshotInterval?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
<pre><code class="hljs css language-json">{<br />  <span class="hljs-attr">"interval"</span>: <span class="hljs-number">1000</span><br />}<br /></code></pre>
</span></div></div><div id="tab-group-34887-content-34890" class="tab-pane" data-group="group_34887" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().setDeduplicationSnapshotInterval(topic, <span class="hljs-number">1000</span>)<br /></code></pre>
</span></div></div></div></div>
<h4><a class="anchor" aria-hidden="true" id="移除去重快照间隔"></a><a href="#移除去重快照间隔" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>移除去重快照间隔</h4>
<p>To remove the topic-level deduplication snapshot interval, use one of the following methods.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34891-tab-34892" class="nav-link active" data-group="group_34891" data-tab="tab-group-34891-content-34892">Pulsar-admin API</div><div id="tab-group-34891-tab-34893" class="nav-link" data-group="group_34891" data-tab="tab-group-34891-content-34893">REST API</div><div id="tab-group-34891-tab-34894" class="nav-link" data-group="group_34891" data-tab="tab-group-34891-content-34894">Java API</div></div><div class="tab-content"><div id="tab-group-34891-content-34892" class="tab-pane active" data-group="group_34891" tabindex="-1"><div><span><pre><code class="hljs">pulsar-<span class="hljs-keyword">admin</span> topics remove-deduplication-<span class="hljs-keyword">snapshot</span>-<span class="hljs-type">interval</span> <span class="hljs-keyword">options</span><br /></code></pre>
</span></div></div><div id="tab-group-34891-content-34893" class="tab-pane" data-group="group_34891" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|DELETE|/admin/v2/topics/:tenant/:namespace/:topic/deduplicationSnapshotInterval?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
</span></div></div><div id="tab-group-34891-content-34894" class="tab-pane" data-group="group_34891" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().removeDeduplicationSnapshotInterval(topic)<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="configure-inactive-topic-policies"></a><a href="#configure-inactive-topic-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure inactive topic policies</h3>
<h4><a class="anchor" aria-hidden="true" id="get-inactive-topic-policies"></a><a href="#get-inactive-topic-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get inactive topic policies</h4>
<p>To get the topic-level inactive topic policies, use one of the following methods.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34895-tab-34896" class="nav-link active" data-group="group_34895" data-tab="tab-group-34895-content-34896">Pulsar-admin API</div><div id="tab-group-34895-tab-34897" class="nav-link" data-group="group_34895" data-tab="tab-group-34895-content-34897">REST API</div><div id="tab-group-34895-tab-34898" class="nav-link" data-group="group_34895" data-tab="tab-group-34895-content-34898">Java API</div></div><div class="tab-content"><div id="tab-group-34895-content-34896" class="tab-pane active" data-group="group_34895" tabindex="-1"><div><span><pre><code class="hljs"><span class="hljs-string">pulsar-admin </span><span class="hljs-string">topics </span><span class="hljs-built_in">get-inactive-topic-policies</span> <span class="hljs-string">options<br /></span></code></pre>
</span></div></div><div id="tab-group-34895-content-34897" class="tab-pane" data-group="group_34895" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|GET|/admin/v2/topics/:tenant/:namespace/:topic/inactiveTopicPolicies?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
</span></div></div><div id="tab-group-34895-content-34898" class="tab-pane" data-group="group_34895" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().getInactiveTopicPolicies(topic)<br /></code></pre>
</span></div></div></div></div>
<h4><a class="anchor" aria-hidden="true" id="set-inactive-topic-policies"></a><a href="#set-inactive-topic-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set inactive topic policies</h4>
<p>To set the topic-level inactive topic policies, use one of the following methods.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34899-tab-34900" class="nav-link active" data-group="group_34899" data-tab="tab-group-34899-content-34900">Pulsar-admin API</div><div id="tab-group-34899-tab-34901" class="nav-link" data-group="group_34899" data-tab="tab-group-34899-content-34901">REST API</div><div id="tab-group-34899-tab-34902" class="nav-link" data-group="group_34899" data-tab="tab-group-34899-content-34902">Java API</div></div><div class="tab-content"><div id="tab-group-34899-content-34900" class="tab-pane active" data-group="group_34899" tabindex="-1"><div><span><pre><code class="hljs"><span class="hljs-string">pulsar-admin </span><span class="hljs-string">topics </span><span class="hljs-built_in">set-inactive-topic-policies</span> <span class="hljs-string">options </span><br /></code></pre>
</span></div></div><div id="tab-group-34899-content-34901" class="tab-pane" data-group="group_34899" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|POST|/admin/v2/topics/:tenant/:namespace/:topic/inactiveTopicPolicies?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
</span></div></div><div id="tab-group-34899-content-34902" class="tab-pane" data-group="group_34899" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().setInactiveTopicPolicies(topic, inactiveTopicPolicies)<br /></code></pre>
</span></div></div></div></div>
<h4><a class="anchor" aria-hidden="true" id="remove-inactive-topic-policies"></a><a href="#remove-inactive-topic-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Remove inactive topic policies</h4>
<p>To remove the topic-level inactive topic policies, use one of the following methods.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34903-tab-34904" class="nav-link active" data-group="group_34903" data-tab="tab-group-34903-content-34904">Pulsar-admin API</div><div id="tab-group-34903-tab-34905" class="nav-link" data-group="group_34903" data-tab="tab-group-34903-content-34905">REST API</div><div id="tab-group-34903-tab-34906" class="nav-link" data-group="group_34903" data-tab="tab-group-34903-content-34906">Java API</div></div><div class="tab-content"><div id="tab-group-34903-content-34904" class="tab-pane active" data-group="group_34903" tabindex="-1"><div><span><pre><code class="hljs">pulsar-<span class="hljs-keyword">admin</span> topics remove-inactive-topic-policies <span class="hljs-keyword">options</span><br /></code></pre>
</span></div></div><div id="tab-group-34903-content-34905" class="tab-pane" data-group="group_34903" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|DELETE|/admin/v2/topics/:tenant/:namespace/:topic/inactiveTopicPolicies?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
</span></div></div><div id="tab-group-34903-content-34906" class="tab-pane" data-group="group_34903" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().removeInactiveTopicPolicies(topic)<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="configure-offload-policies"></a><a href="#configure-offload-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure offload policies</h3>
<h4><a class="anchor" aria-hidden="true" id="get-offload-policies"></a><a href="#get-offload-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get offload policies</h4>
<p>To get the topic-level offload policies, use one of the following methods.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34907-tab-34908" class="nav-link active" data-group="group_34907" data-tab="tab-group-34907-content-34908">Pulsar-admin API</div><div id="tab-group-34907-tab-34909" class="nav-link" data-group="group_34907" data-tab="tab-group-34907-content-34909">REST API</div><div id="tab-group-34907-tab-34910" class="nav-link" data-group="group_34907" data-tab="tab-group-34907-content-34910">Java API</div></div><div class="tab-content"><div id="tab-group-34907-content-34908" class="tab-pane active" data-group="group_34907" tabindex="-1"><div><span><pre><code class="hljs"><span class="hljs-string">pulsar-admin </span><span class="hljs-string">topics </span><span class="hljs-built_in">get-offload-policies</span> <span class="hljs-string">options<br /></span></code></pre>
</span></div></div><div id="tab-group-34907-content-34909" class="tab-pane" data-group="group_34907" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|GET|/admin/v2/topics/:tenant/:namespace/:topic/offloadPolicies?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
</span></div></div><div id="tab-group-34907-content-34910" class="tab-pane" data-group="group_34907" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().getOffloadPolicies(topic)<br /></code></pre>
</span></div></div></div></div>
<h4><a class="anchor" aria-hidden="true" id="set-offload-policies"></a><a href="#set-offload-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set offload policies</h4>
<p>To set the topic-level offload policies, use one of the following methods.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34911-tab-34912" class="nav-link active" data-group="group_34911" data-tab="tab-group-34911-content-34912">Pulsar-admin API</div><div id="tab-group-34911-tab-34913" class="nav-link" data-group="group_34911" data-tab="tab-group-34911-content-34913">REST API</div><div id="tab-group-34911-tab-34914" class="nav-link" data-group="group_34911" data-tab="tab-group-34911-content-34914">Java API</div></div><div class="tab-content"><div id="tab-group-34911-content-34912" class="tab-pane active" data-group="group_34911" tabindex="-1"><div><span><pre><code class="hljs"><span class="hljs-string">pulsar-admin </span><span class="hljs-string">topics </span><span class="hljs-built_in">set-offload-policies</span> <span class="hljs-string">options </span><br /></code></pre>
</span></div></div><div id="tab-group-34911-content-34913" class="tab-pane" data-group="group_34911" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|POST|/admin/v2/topics/:tenant/:namespace/:topic/offloadPolicies?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
</span></div></div><div id="tab-group-34911-content-34914" class="tab-pane" data-group="group_34911" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().setOffloadPolicies(topic, offloadPolicies)<br /></code></pre>
</span></div></div></div></div>
<h4><a class="anchor" aria-hidden="true" id="remove-offload-policies"></a><a href="#remove-offload-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Remove offload policies</h4>
<p>To remove the topic-level offload policies, use one of the following methods.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34915-tab-34916" class="nav-link active" data-group="group_34915" data-tab="tab-group-34915-content-34916">Pulsar-admin API</div><div id="tab-group-34915-tab-34917" class="nav-link" data-group="group_34915" data-tab="tab-group-34915-content-34917">REST API</div><div id="tab-group-34915-tab-34918" class="nav-link" data-group="group_34915" data-tab="tab-group-34915-content-34918">Java API</div></div><div class="tab-content"><div id="tab-group-34915-content-34916" class="tab-pane active" data-group="group_34915" tabindex="-1"><div><span><pre><code class="hljs">pulsar-<span class="hljs-keyword">admin</span> topics remove-offload-policies <span class="hljs-keyword">options</span><br /></code></pre>
</span></div></div><div id="tab-group-34915-content-34917" class="tab-pane" data-group="group_34915" tabindex="-1"><div><span><pre><code class="hljs">{<span class="hljs-variable">@inject:</span> endpoint|DELETE|/admin/v2/topics/:tenant/:namespace/:topic/offloadPolicies?version=[[<span class="hljs-attribute">pulsar</span>:version_number]]}<br /></code></pre>
</span></div></div><div id="tab-group-34915-content-34918" class="tab-pane" data-group="group_34915" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().removeOffloadPolicies(topic)<br /></code></pre>
</span></div></div></div></div>
<h2><a class="anchor" aria-hidden="true" id="管理非分区主题"></a><a href="#管理非分区主题" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>管理非分区主题</h2>
<p>可以使用 Pulsar <a href="/docs/zh-CN/admin-api-overview">admin API</a> 来创建、删除和检查非分区主题的状态。</p>
<h3><a class="anchor" aria-hidden="true" id="创建"></a><a href="#创建" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建</h3>
<p>必须明确创建非分区主题。 当创建一个新的非分区主题时，需要为该主题提供一个名称。</p>
<p>默认情况下，创建 60 秒后，主题会被视为不活跃，并自动删除，以避免生成垃圾数据。 To disable this feature, set <code>brokerDeleteInactiveTopicsEnabled</code> to <code>false</code>. 设置 <code>brokerDeleteInactiveTopicsFrequencySeconds</code> 为特殊值以改变检查非活动主题的频率。</p>
<p>关于这两个参数的更多信息，请参阅 <a href="/docs/zh-CN/reference-configuration#broker">这里</a>。</p>
<p>可以通过以下方式创建非分区主题。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34919-tab-34920" class="nav-link active" data-group="group_34919" data-tab="tab-group-34919-content-34920">pulsar-admin</div><div id="tab-group-34919-tab-34921" class="nav-link" data-group="group_34919" data-tab="tab-group-34919-content-34921">REST API</div><div id="tab-group-34919-tab-34922" class="nav-link" data-group="group_34919" data-tab="tab-group-34919-content-34922">Java</div></div><div class="tab-content"><div id="tab-group-34919-content-34920" class="tab-pane active" data-group="group_34919" tabindex="-1"><div><span><p>When you create non-partitioned topics with the <a href="/docs/zh-CN/pulsar-admin#create-3"><code>create</code></a> command, you need to specify the topic name as an argument.</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> bin/pulsar-admin topics create \</span><br />  persistent://my-tenant/my-namespace/my-topic<br /></code></pre>
<blockquote>
<p><strong>备注</strong>    <br>
当你创建一个后缀为 ''-partition-' 的非分区主题时，主题名称后跟数字值，如 'xyz-topic-partition-x' ，如果存在 'xyz-topic-partition-y' 的分区主题，那么非分区主题的数字值（x）必须大于分区主题的分区数（y）。 否则就无法创建未分区主题。</p>
</blockquote>
</span></div></div><div id="tab-group-34919-content-34921" class="tab-pane" data-group="group_34919" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/createNonPartitionedTopic?version=2.9.1&amp;apiVersion=v2"><b>PUT</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic</i></a>
</p>
</span></div></div><div id="tab-group-34919-content-34922" class="tab-pane" data-group="group_34919" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topicName = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().createNonPartitionedTopic(topicName);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="删除"></a><a href="#删除" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>删除</h3>
<p>可以通过以下方式来删除非分区主题。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34923-tab-34924" class="nav-link active" data-group="group_34923" data-tab="tab-group-34923-content-34924">pulsar-admin</div><div id="tab-group-34923-tab-34925" class="nav-link" data-group="group_34923" data-tab="tab-group-34923-content-34925">REST API</div><div id="tab-group-34923-tab-34926" class="nav-link" data-group="group_34923" data-tab="tab-group-34923-content-34926">Java</div></div><div class="tab-content"><div id="tab-group-34923-content-34924" class="tab-pane active" data-group="group_34923" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> bin/pulsar-admin topics delete \</span><br />  persistent://my-tenant/my-namespace/my-topic<br /></code></pre>
</span></div></div><div id="tab-group-34923-content-34925" class="tab-pane" data-group="group_34923" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/deleteTopic?version=2.9.1&amp;apiVersion=v2"><b>DELETE</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic</i></a>
</p>
</span></div></div><div id="tab-group-34923-content-34926" class="tab-pane" data-group="group_34923" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().delete(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取资源列表"></a><a href="#获取资源列表" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取资源列表</h3>
<p>你可以通过以下方式获得特定命名空间下的 topic 列表。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34927-tab-34928" class="nav-link active" data-group="group_34927" data-tab="tab-group-34927-content-34928">pulsar-admin</div><div id="tab-group-34927-tab-34929" class="nav-link" data-group="group_34927" data-tab="tab-group-34927-content-34929">REST API</div><div id="tab-group-34927-tab-34930" class="nav-link" data-group="group_34927" data-tab="tab-group-34927-content-34930">Java</div></div><div class="tab-content"><div id="tab-group-34927-content-34928" class="tab-pane active" data-group="group_34927" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics list tenant/namespace</span><br />persistent://tenant/namespace/topic1<br />persistent://tenant/namespace/topic2<br /></code></pre>
</span></div></div><div id="tab-group-34927-content-34929" class="tab-pane" data-group="group_34927" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getList?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace</i></a>
</p>
</span></div></div><div id="tab-group-34927-content-34930" class="tab-pane" data-group="group_34927" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().getList(namespace);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="统计信息"></a><a href="#统计信息" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>统计信息</h3>
<p>检查某个主题的当前统计数据。 The following is an example. 关于每个统计数据的描述，参见 <a href="#get-stats">get stats</a>。</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"msgRateIn"</span>: <span class="hljs-number">4641.528542257553</span>,
  <span class="hljs-attr">"msgThroughputIn"</span>: <span class="hljs-number">44663039.74947473</span>,
  <span class="hljs-attr">"msgRateOut"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"msgThroughputOut"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"averageMsgSize"</span>: <span class="hljs-number">1232439.816728665</span>,
  <span class="hljs-attr">"storageSize"</span>: <span class="hljs-number">135532389160</span>,
  <span class="hljs-attr">"publishers"</span>: [
    {
      <span class="hljs-attr">"msgRateIn"</span>: <span class="hljs-number">57.855383881403576</span>,
      <span class="hljs-attr">"msgThroughputIn"</span>: <span class="hljs-number">558994.7078932219</span>,
      <span class="hljs-attr">"averageMsgSize"</span>: <span class="hljs-number">613135</span>,
      <span class="hljs-attr">"producerId"</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">"producerName"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">"address"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">"connectedSince"</span>: <span class="hljs-literal">null</span>
    }
  ],
  <span class="hljs-attr">"subscriptions"</span>: {
    <span class="hljs-attr">"my-topic_subscription"</span>: {
      <span class="hljs-attr">"msgRateOut"</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">"msgThroughputOut"</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">"msgBacklog"</span>: <span class="hljs-number">116632</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">"msgRateExpired"</span>: <span class="hljs-number">36.98245516804671</span>,
      <span class="hljs-attr">"consumers"</span>: []
    }
  },
  <span class="hljs-attr">"replication"</span>: {}
}
</code></pre>
<p>可以通过以下方式检查某个主题及其相关生产者和消费者的当前统计数据。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34931-tab-34932" class="nav-link active" data-group="group_34931" data-tab="tab-group-34931-content-34932">pulsar-admin</div><div id="tab-group-34931-tab-34933" class="nav-link" data-group="group_34931" data-tab="tab-group-34931-content-34933">REST API</div><div id="tab-group-34931-tab-34934" class="nav-link" data-group="group_34931" data-tab="tab-group-34931-content-34934">Java</div></div><div class="tab-content"><div id="tab-group-34931-content-34932" class="tab-pane active" data-group="group_34931" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics stats \</span><br />  persistent://test-tenant/namespace/topic \<br />  --get-precise-backlog<br /></code></pre>
</span></div></div><div id="tab-group-34931-content-34933" class="tab-pane" data-group="group_34931" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getStats?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/stats</i></a>
</p>
</span></div></div><div id="tab-group-34931-content-34934" class="tab-pane" data-group="group_34931" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().getStats(topic, <span class="hljs-keyword">false</span> <span class="hljs-comment">/* is precise backlog */</span>);<br /></code></pre>
</span></div></div></div></div>
<h2><a class="anchor" aria-hidden="true" id="管理分区主题"></a><a href="#管理分区主题" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>管理分区主题</h2>
<p>可以使用 Pulsar <a href="/docs/zh-CN/admin-api-overview">admin API</a> 来创建、更新、删除和检查分区主题的状态。</p>
<h3><a class="anchor" aria-hidden="true" id="创建-1"></a><a href="#创建-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建</h3>
<p>必须明确创建分区主题。 当创建一个新的分区主题时，需要为该主题提供一个名称和分区数量。</p>
<p>默认情况下，创建 60 秒后，主题会被视为不活跃，并自动删除，以避免生成垃圾数据。 To disable this feature, set <code>brokerDeleteInactiveTopicsEnabled</code> to <code>false</code>. 设置 <code>brokerDeleteInactiveTopicsFrequencySeconds</code> 为特殊值以改变检查非活动主题的频率。</p>
<p>关于这两个参数的更多信息，请参阅 <a href="/docs/zh-CN/reference-configuration#broker">这里</a>。</p>
<p>可以通过以下方式创建分区主题。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34935-tab-34936" class="nav-link active" data-group="group_34935" data-tab="tab-group-34935-content-34936">pulsar-admin</div><div id="tab-group-34935-tab-34937" class="nav-link" data-group="group_34935" data-tab="tab-group-34935-content-34937">REST API</div><div id="tab-group-34935-tab-34938" class="nav-link" data-group="group_34935" data-tab="tab-group-34935-content-34938">Java</div></div><div class="tab-content"><div id="tab-group-34935-content-34936" class="tab-pane active" data-group="group_34935" tabindex="-1"><div><span><p>When you create partitioned topics with the <a href="/docs/zh-CN/pulsar-admin#create-partitioned-topic"><code>create-partitioned-topic</code></a> command, you need to specify the topic name as an argument and the number of partitions using the <code>-p</code> or <code>--partitions</code> flag.</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> bin/pulsar-admin topics create-partitioned-topic \</span><br />  persistent://my-tenant/my-namespace/my-topic \<br />  --partitions 4<br /></code></pre>
<blockquote>
<p><strong>备注</strong>    <br>
如果一个非分区主题的后缀是 '-partition-' 并且后面跟着一个数字值，比如 'xyz-topic-partition-10'，那么就不能创建名为 'xyz-topic' 的分区主题，因为分区主题的分区可以覆盖现有的非分区主题。 必须删除上述的非分区主题，才能创建该分区主题。</p>
</blockquote>
</span></div></div><div id="tab-group-34935-content-34937" class="tab-pane" data-group="group_34935" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/createPartitionedTopic?version=2.9.1&amp;apiVersion=v2"><b>PUT</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/partitions</i></a>
</p>
</span></div></div><div id="tab-group-34935-content-34938" class="tab-pane" data-group="group_34935" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topicName = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br /><span class="hljs-keyword">int</span> numPartitions = <span class="hljs-number">4</span>;<br />admin.topics().createPartitionedTopic(topicName, numPartitions);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="create-missed-partitions"></a><a href="#create-missed-partitions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create missed partitions</h3>
<p>在主题的 auto-creation 是禁用状态并且有一个没有任何分区的主题时，可以使用 <a href="/docs/zh-CN/pulsar-admin#create-missed-partitions"><code>create-missed-partitions</code></a> 命令为主题创建分区。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34939-tab-34940" class="nav-link active" data-group="group_34939" data-tab="tab-group-34939-content-34940">pulsar-admin</div><div id="tab-group-34939-tab-34941" class="nav-link" data-group="group_34939" data-tab="tab-group-34939-content-34941">REST API</div><div id="tab-group-34939-tab-34942" class="nav-link" data-group="group_34939" data-tab="tab-group-34939-content-34942">Java</div></div><div class="tab-content"><div id="tab-group-34939-content-34940" class="tab-pane active" data-group="group_34939" tabindex="-1"><div><span><p>可以用 <a href="/docs/zh-CN/pulsar-admin#create-missed-partitions"><code>create-missed-partitions</code></a> 命令指定主题名称作为参数来创建 miss 分区。</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> bin/pulsar-admin topics create-missed-partitions \</span><br />  persistent://my-tenant/my-namespace/my-topic \<br /></code></pre>
</span></div></div><div id="tab-group-34939-content-34941" class="tab-pane" data-group="group_34939" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/createMissedPartitions?version=2.9.1&amp;apiVersion=v2"><b>POST</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic</i></a>
</p>
</span></div></div><div id="tab-group-34939-content-34942" class="tab-pane" data-group="group_34939" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topicName = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().createMissedPartitions(topicName);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取元数据"></a><a href="#获取元数据" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取元数据</h3>
<p>已分区的主题与元数据相关联，可以将其看作一个 JSON 对象。 以下元数据字段是可用的。</p>
<table>
<thead>
<tr><th style="text-align:left">字段</th><th style="text-align:left">说明</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>分区</code></td><td style="text-align:left">主题中的分区数量。</td></tr>
</tbody>
</table>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34943-tab-34944" class="nav-link active" data-group="group_34943" data-tab="tab-group-34943-content-34944">pulsar-admin</div><div id="tab-group-34943-tab-34945" class="nav-link" data-group="group_34943" data-tab="tab-group-34943-content-34945">REST API</div><div id="tab-group-34943-tab-34946" class="nav-link" data-group="group_34943" data-tab="tab-group-34943-content-34946">Java</div></div><div class="tab-content"><div id="tab-group-34943-content-34944" class="tab-pane active" data-group="group_34943" tabindex="-1"><div><span><p>可以通过 <a href="/docs/zh-CN/pulsar-admin#get-partitioned-topic-metadata"><code>get-partitioned-topic-metadata</code></a> 子命令检查分区主题的分区数量。</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics get-partitioned-topic-metadata \</span><br />  persistent://my-tenant/my-namespace/my-topic<br />{<br />  "partitions": 4<br />}<br /></code></pre>
</span></div></div><div id="tab-group-34943-content-34945" class="tab-pane" data-group="group_34943" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getPartitionedMetadata?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/partitions</i></a>
</p>
</span></div></div><div id="tab-group-34943-content-34946" class="tab-pane" data-group="group_34943" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topicName = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />admin.topics().getPartitionedTopicMetadata(topicName);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="更新"></a><a href="#更新" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>更新</h3>
<p><em>如果</em> 主题是非全局的，你可以更新现有已分区主题的分区数量。 然而，你只能添加分区号。 减少分区的数量就会删除对应主题，在 Pulsar 中是不支持的。</p>
<p>生产者和消费者可以自动找到新创建的分区。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34947-tab-34948" class="nav-link active" data-group="group_34947" data-tab="tab-group-34947-content-34948">pulsar-admin</div><div id="tab-group-34947-tab-34949" class="nav-link" data-group="group_34947" data-tab="tab-group-34947-content-34949">REST API</div><div id="tab-group-34947-tab-34950" class="nav-link" data-group="group_34947" data-tab="tab-group-34947-content-34950">Java</div></div><div class="tab-content"><div id="tab-group-34947-content-34948" class="tab-pane active" data-group="group_34947" tabindex="-1"><div><span><p>可以使用 <a href="/docs/zh-CN/pulsar-admin#update-partitioned-topic"><code>update-partitioned-topic</code></a> 命令更新分区主题。</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics update-partitioned-topic \</span><br />  persistent://my-tenant/my-namespace/my-topic \<br />  --partitions 8<br /></code></pre>
</span></div></div><div id="tab-group-34947-content-34949" class="tab-pane" data-group="group_34947" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/updatePartitionedTopic?version=2.9.1&amp;apiVersion=v2"><b>POST</b> <i>/admin/v2/:schema/:tenant/:cluster/:namespace/:destination/partitions</i></a>
</p>
</span></div></div><div id="tab-group-34947-content-34950" class="tab-pane" data-group="group_34947" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().updatePartitionedTopic(topic, numPartitions);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="删除-1"></a><a href="#删除-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>删除</h3>
<p>可以使用 <a href="/docs/zh-CN/pulsar-admin#delete-partitioned-topic"><code>delete-partitioned-topic</code></a> 命令、REST API 或者 Java 删除分区主题。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34951-tab-34952" class="nav-link active" data-group="group_34951" data-tab="tab-group-34951-content-34952">pulsar-admin</div><div id="tab-group-34951-tab-34953" class="nav-link" data-group="group_34951" data-tab="tab-group-34951-content-34953">REST API</div><div id="tab-group-34951-tab-34954" class="nav-link" data-group="group_34951" data-tab="tab-group-34951-content-34954">Java</div></div><div class="tab-content"><div id="tab-group-34951-content-34952" class="tab-pane active" data-group="group_34951" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> bin/pulsar-admin topics delete-partitioned-topic \</span><br />  persistent://my-tenant/my-namespace/my-topic<br /></code></pre>
</span></div></div><div id="tab-group-34951-content-34953" class="tab-pane" data-group="group_34951" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/deletePartitionedTopic?version=2.9.1&amp;apiVersion=v2"><b>DELETE</b> <i>/admin/v2/:schema/:topic/:namespace/:destination/partitions</i></a>
</p>
</span></div></div><div id="tab-group-34951-content-34954" class="tab-pane" data-group="group_34951" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().delete(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取资源列表-1"></a><a href="#获取资源列表-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取资源列表</h3>
<p>你可以通过以下方式获得特定命名空间下的 topic 列表。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34955-tab-34956" class="nav-link active" data-group="group_34955" data-tab="tab-group-34955-content-34956">pulsar-admin</div><div id="tab-group-34955-tab-34957" class="nav-link" data-group="group_34955" data-tab="tab-group-34955-content-34957">REST API</div><div id="tab-group-34955-tab-34958" class="nav-link" data-group="group_34955" data-tab="tab-group-34955-content-34958">Java</div></div><div class="tab-content"><div id="tab-group-34955-content-34956" class="tab-pane active" data-group="group_34955" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics list tenant/namespace</span><br />persistent://tenant/namespace/topic1<br />persistent://tenant/namespace/topic2<br /></code></pre>
</span></div></div><div id="tab-group-34955-content-34957" class="tab-pane" data-group="group_34955" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getPartitionedTopicList?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace</i></a>
</p>
</span></div></div><div id="tab-group-34955-content-34958" class="tab-pane" data-group="group_34955" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().getList(namespace);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="统计信息-1"></a><a href="#统计信息-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>统计信息</h3>
<p>可以查看某个主题的当前统计数据。 The following is an example. 关于每个统计数据的描述，参见 <a href="#get-stats">get stats</a>。</p>
<p>请注意，在订阅的 JSON 对象中， <code>chuckedMessageRate</code> 已被废弃。 请使用 <code>chunkedMessageRate</code>。 两者目前都将发送到 JSON 中。</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"msgRateIn"</span> : <span class="hljs-number">999.992947159793</span>,
  <span class="hljs-attr">"msgThroughputIn"</span> : <span class="hljs-number">1070918.4635439808</span>,
  <span class="hljs-attr">"msgRateOut"</span> : <span class="hljs-number">0.0</span>,
  <span class="hljs-attr">"msgThroughputOut"</span> : <span class="hljs-number">0.0</span>,
  <span class="hljs-attr">"bytesInCounter"</span> : <span class="hljs-number">270318763</span>,
  <span class="hljs-attr">"msgInCounter"</span> : <span class="hljs-number">252489</span>,
  <span class="hljs-attr">"bytesOutCounter"</span> : <span class="hljs-number">0</span>,
  <span class="hljs-attr">"msgOutCounter"</span> : <span class="hljs-number">0</span>,
  <span class="hljs-attr">"averageMsgSize"</span> : <span class="hljs-number">1070.926056966454</span>,
  <span class="hljs-attr">"msgChunkPublished"</span> : <span class="hljs-literal">false</span>,
  <span class="hljs-attr">"storageSize"</span> : <span class="hljs-number">270316646</span>,
  <span class="hljs-attr">"backlogSize"</span> : <span class="hljs-number">200921133</span>,
  <span class="hljs-attr">"publishers"</span> : [ {
    <span class="hljs-attr">"msgRateIn"</span> : <span class="hljs-number">999.992947159793</span>,
    <span class="hljs-attr">"msgThroughputIn"</span> : <span class="hljs-number">1070918.4635439808</span>,
    <span class="hljs-attr">"averageMsgSize"</span> : <span class="hljs-number">1070.3333333333333</span>,
    <span class="hljs-attr">"chunkedMessageRate"</span> : <span class="hljs-number">0.0</span>,
    <span class="hljs-attr">"producerId"</span> : <span class="hljs-number">0</span>
  } ],
  <span class="hljs-attr">"subscriptions"</span> : {
    <span class="hljs-attr">"test"</span> : {
      <span class="hljs-attr">"msgRateOut"</span> : <span class="hljs-number">0.0</span>,
      <span class="hljs-attr">"msgThroughputOut"</span> : <span class="hljs-number">0.0</span>,
      <span class="hljs-attr">"bytesOutCounter"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"msgOutCounter"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"msgRateRedeliver"</span> : <span class="hljs-number">0.0</span>,
      <span class="hljs-attr">"chuckedMessageRate"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"chunkedMessageRate"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"msgBacklog"</span> : <span class="hljs-number">144318</span>,
      <span class="hljs-attr">"msgBacklogNoDelayed"</span> : <span class="hljs-number">144318</span>,
      <span class="hljs-attr">"blockedSubscriptionOnUnackedMsgs"</span> : <span class="hljs-literal">false</span>,
      <span class="hljs-attr">"msgDelayed"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"unackedMessages"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"msgRateExpired"</span> : <span class="hljs-number">0.0</span>,
      <span class="hljs-attr">"lastExpireTimestamp"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"lastConsumedFlowTimestamp"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"lastConsumedTimestamp"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"lastAckedTimestamp"</span> : <span class="hljs-number">0</span>,
      <span class="hljs-attr">"consumers"</span> : [ ],
      <span class="hljs-attr">"isDurable"</span> : <span class="hljs-literal">true</span>,
      <span class="hljs-attr">"isReplicated"</span> : <span class="hljs-literal">false</span>
    }
  },
  <span class="hljs-attr">"replication"</span> : { },
  <span class="hljs-attr">"metadata"</span> : {
    <span class="hljs-attr">"partitions"</span> : <span class="hljs-number">3</span>
  },
  <span class="hljs-attr">"partitions"</span> : { }
}
</code></pre>
<p>你可以通过以下方式检查给定分区主题及其当前连接的生产者和消费者的统计信息。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34959-tab-34960" class="nav-link active" data-group="group_34959" data-tab="tab-group-34959-content-34960">pulsar-admin</div><div id="tab-group-34959-tab-34961" class="nav-link" data-group="group_34959" data-tab="tab-group-34959-content-34961">REST API</div><div id="tab-group-34959-tab-34962" class="nav-link" data-group="group_34959" data-tab="tab-group-34959-content-34962">Java</div></div><div class="tab-content"><div id="tab-group-34959-content-34960" class="tab-pane active" data-group="group_34959" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics partitioned-stats \</span><br />  persistent://test-tenant/namespace/topic \<br />  --per-partition<br /></code></pre>
</span></div></div><div id="tab-group-34959-content-34961" class="tab-pane" data-group="group_34959" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getPartitionedStats?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/partitioned-stats</i></a>
</p>
</span></div></div><div id="tab-group-34959-content-34962" class="tab-pane" data-group="group_34959" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().getPartitionedStats(topic, <span class="hljs-keyword">true</span> <span class="hljs-comment">/* per partition */</span>, <span class="hljs-keyword">false</span> <span class="hljs-comment">/* is precise backlog */</span>);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="internal-stats"></a><a href="#internal-stats" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Internal stats</h3>
<p>你可以检查主题的详细统计数据。 The following is an example. 有关每个统计信息的说明，详见<a href="#get-internal-stats">获取内部统计信息</a>。</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"entriesAddedCounter"</span>: <span class="hljs-number">20449518</span>,
  <span class="hljs-attr">"numberOfEntries"</span>: <span class="hljs-number">3233</span>,
  <span class="hljs-attr">"totalSize"</span>: <span class="hljs-number">331482</span>,
  <span class="hljs-attr">"currentLedgerEntries"</span>: <span class="hljs-number">3233</span>,
  <span class="hljs-attr">"currentLedgerSize"</span>: <span class="hljs-number">331482</span>,
  <span class="hljs-attr">"lastLedgerCreatedTimestamp"</span>: <span class="hljs-string">"2016-06-29 03:00:23.825"</span>,
  <span class="hljs-attr">"lastLedgerCreationFailureTimestamp"</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">"waitingCursorsCount"</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">"pendingAddEntriesCount"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"lastConfirmedEntry"</span>: <span class="hljs-string">"324711539:3232"</span>,
  <span class="hljs-attr">"state"</span>: <span class="hljs-string">"LedgerOpened"</span>,
  <span class="hljs-attr">"ledgers"</span>: [
    {
      <span class="hljs-attr">"ledgerId"</span>: <span class="hljs-number">324711539</span>,
      <span class="hljs-attr">"entries"</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>
    }
  ],
  <span class="hljs-attr">"cursors"</span>: {
    <span class="hljs-attr">"my-subscription"</span>: {
      <span class="hljs-attr">"markDeletePosition"</span>: <span class="hljs-string">"324711539:3133"</span>,
      <span class="hljs-attr">"readPosition"</span>: <span class="hljs-string">"324711539:3233"</span>,
      <span class="hljs-attr">"waitingReadOp"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">"pendingReadOps"</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">"messagesConsumedCounter"</span>: <span class="hljs-number">20449501</span>,
      <span class="hljs-attr">"cursorLedger"</span>: <span class="hljs-number">324702104</span>,
      <span class="hljs-attr">"cursorLedgerLastEntry"</span>: <span class="hljs-number">21</span>,
      <span class="hljs-attr">"individuallyDeletedMessages"</span>: <span class="hljs-string">"[(324711539:3134‥324711539:3136], (324711539:3137‥324711539:3140], ]"</span>,
      <span class="hljs-attr">"lastLedgerSwitchTimestamp"</span>: <span class="hljs-string">"2016-06-29 01:30:19.313"</span>,
      <span class="hljs-attr">"state"</span>: <span class="hljs-string">"Open"</span>
    }
  }
}
</code></pre>
<p>你可以通过以下方式获取分区主题的内部统计信息。</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34963-tab-34964" class="nav-link active" data-group="group_34963" data-tab="tab-group-34963-content-34964">pulsar-admin</div><div id="tab-group-34963-tab-34965" class="nav-link" data-group="group_34963" data-tab="tab-group-34963-content-34965">REST API</div><div id="tab-group-34963-tab-34966" class="nav-link" data-group="group_34963" data-tab="tab-group-34963-content-34966">Java</div></div><div class="tab-content"><div id="tab-group-34963-content-34964" class="tab-pane active" data-group="group_34963" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics stats-internal \</span><br />  persistent://test-tenant/namespace/topic<br /></code></pre>
</span></div></div><div id="tab-group-34963-content-34965" class="tab-pane" data-group="group_34963" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getInternalStats?version=2.9.1&amp;apiVersion=v2"><b>GET</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/internalStats</i></a>
</p>
</span></div></div><div id="tab-group-34963-content-34966" class="tab-pane" data-group="group_34963" tabindex="-1"><div><span><pre><code class="hljs css language-java">admin.topics().getInternalStats(topic);<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="获取-backlog-大小"></a><a href="#获取-backlog-大小" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>获取 backlog 大小</h3>
<p>You can get backlog size of a single topic partition or a nonpartitioned topic given a message ID (in bytes).</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-34967-tab-34968" class="nav-link active" data-group="group_34967" data-tab="tab-group-34967-content-34968">pulsar-admin</div><div id="tab-group-34967-tab-34969" class="nav-link" data-group="group_34967" data-tab="tab-group-34967-content-34969">REST API</div><div id="tab-group-34967-tab-34970" class="nav-link" data-group="group_34967" data-tab="tab-group-34967-content-34970">Java</div></div><div class="tab-content"><div id="tab-group-34967-content-34968" class="tab-pane active" data-group="group_34967" tabindex="-1"><div><span><pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> pulsar-admin topics get-backlog-size \</span><br />  -m 1:1 \<br />  persistent://test-tenant/ns1/tp1-partition-0 \<br /></code></pre>
</span></div></div><div id="tab-group-34967-content-34969" class="tab-pane" data-group="group_34967" tabindex="-1"><div><span><p><a href="https://pulsar.apache.org/admin-rest-api#operation/getBacklogSizeByMessageId?version=2.9.1&amp;apiVersion=v2"><b>PUT</b> <i>/admin/v2/:schema/:tenant/:namespace/:topic/backlogSize</i></a>
</p>
</span></div></div><div id="tab-group-34967-content-34970" class="tab-pane" data-group="group_34967" tabindex="-1"><div><span><pre><code class="hljs css language-java">String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;<br />MessageId messageId = MessageId.earliest;<br />admin.topics().getBacklogSizeByMessageId(topic, messageId);<br /></code></pre>
</span></div></div></div></div>
<h2><a class="anchor" aria-hidden="true" id="发布到分区主题"></a><a href="#发布到分区主题" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>发布到分区主题</h2>
<p>默认情况下，Pulsar 主题由单个 broker 提供服务，这限制了主题的最大吞吐量。 <em>分区主题</em>可以跨越多个 broker，从而实现更高的吞吐量。</p>
<p>你可以使用 Pulsar 客户端库发布到分区主题。 发布到分区主题时，必须指定路由模式。 如果在创建新的生产者时没有指定任何路由方式，则使用轮询路由模式。</p>
<h3><a class="anchor" aria-hidden="true" id="routing-mode"></a><a href="#routing-mode" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Routing mode</h3>
<p>You can specify the routing mode in the ProducerConfiguration object that you use to configure your producer. The routing mode determines which partition(internal topic) that each message should be published to.</p>
<p>The following <a href="https://pulsar.apache.org/api/client/2.9.0-SNAPSHOT/org/apache/pulsar/client/api/MessageRoutingMode">MessageRoutingMode</a>
 options are available.</p>
<table>
<thead>
<tr><th style="text-align:left">发送模式</th><th style="text-align:left">说明</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>RoundRobinPartition</code></td><td style="text-align:left">如果没有提供 key，生产者将在所有分区中以轮训策略进行发布消息，以达到最大的吞吐量。 请注意轮训并不是作用于每条单独的消息，而是作用于延迟处理的批次边界，以确保批处理有效。 如果在消息上指定了 key ，分区生产者会根据 key 的 hash 值将消息分配给对应的分区。 这是默认的模式。</td></tr>
<tr><td style="text-align:left"><code>SinglePartition</code></td><td style="text-align:left">如果消息没有指定 key，生产者会随机挑选一个分区，并发布所有消息到该分区。 如果在消息上指定了 key ，分区生产者会根据 key 的 hash 值将消息分配给对应的分区。</td></tr>
<tr><td style="text-align:left"><code>CustomPartition</code></td><td style="text-align:left">使用自定义消息路由器实现来决定特定消息的分区。 你可以通过使用 Java 客户端和实现 <a href="https://pulsar.apache.org/api/client/2.9.0-SNAPSHOT/org/apache/pulsar/client/api/MessageRouter">MessageRouter</a>
 接口来创建一个自定义路由模式。</td></tr>
</tbody>
</table>
<p>如下所示：</p>
<pre><code class="hljs css language-java">String pulsarBrokerRootUrl = <span class="hljs-string">"pulsar://localhost:6650"</span>;
String topic = <span class="hljs-string">"persistent://my-tenant/my-namespace/my-topic"</span>;

PulsarClient pulsarClient = PulsarClient.builder().serviceUrl(pulsarBrokerRootUrl).build();
Producer&lt;<span class="hljs-keyword">byte</span>[]&gt; producer = pulsarClient.newProducer()
        .topic(topic)
        .messageRoutingMode(MessageRoutingMode.SinglePartition)
        .create();
producer.send(<span class="hljs-string">"Partitioned topic message"</span>.getBytes());
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="custom-message-router"></a><a href="#custom-message-router" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom message router</h3>
<p>要使用自定义消息路由器，您需要提供<a href="https://pulsar.apache.org/api/client/2.9.0-SNAPSHOT/org/apache/pulsar/client/api/MessageRouter">MessageRouter</a>
 接口的实现，该接口只有一个<code>choosePartition</code>方法：</p>
<pre><code class="hljs css language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">MessageRouter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">choosePartition</span><span class="hljs-params">(Message msg)</span></span>;
}
</code></pre>
<p>下面的路由模式表示所有的消息都会被发送到分区10：</p>
<pre><code class="hljs css language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AlwaysTenRouter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MessageRouter</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">choosePartition</span><span class="hljs-params">(Message msg)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-number">10</span>;
    }
}
</code></pre>
<p>With that implementation, you can send</p>
<pre><code class="hljs css language-java">String pulsarBrokerRootUrl = <span class="hljs-string">"pulsar://localhost:6650"</span>;
String topic = <span class="hljs-string">"persistent://my-tenant/my-cluster-my-namespace/my-topic"</span>;

PulsarClient pulsarClient = PulsarClient.builder().serviceUrl(pulsarBrokerRootUrl).build();
Producer&lt;<span class="hljs-keyword">byte</span>[]&gt; producer = pulsarClient.newProducer()
        .topic(topic)
        .messageRouter(<span class="hljs-keyword">new</span> AlwaysTenRouter())
        .create();
producer.send(<span class="hljs-string">"Partitioned topic message"</span>.getBytes());
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="使用-key-时如何选择分区"></a><a href="#使用-key-时如何选择分区" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用 Key 时如何选择分区</h3>
<p>If a message has a key, it supersedes the round robin routing policy. The following example illustrates how to choose the partition when using a key.</p>
<pre><code class="hljs css language-java"><span class="hljs-comment">// 如果消息存在key，轮询路由策略将被替换</span>
        <span class="hljs-keyword">if</span> (msg.hasKey()) {
            <span class="hljs-keyword">return</span> signSafeMod(hash.makeHash(msg.getKey()), topicMetadata.numPartitions());
        }

        <span class="hljs-keyword">if</span> (isBatchingEnabled) { <span class="hljs-comment">// 如果开启批处理，请在  `partitionSwitchMs`  边界上选择分区。</span>
            <span class="hljs-keyword">long</span> currentMs = clock.millis();
            <span class="hljs-keyword">return</span> signSafeMod(currentMs / partitionSwitchMs + startPtnIdx, topicMetadata.numPartiations());
        other.
            <span class="hljs-keyword">return</span> signSafeMod(PARTITION_INDEX_UPDATER.getAndIncrement(<span class="hljs-keyword">this</span>), topicMetadata.numPartiations());
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/zh-CN/admin-api-permissions"><span class="arrow-prev">← </span><span>权限管理</span></a><a class="docs-next button" href="/docs/zh-CN/admin-api-functions"><span>Functions</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#管理主题资源">管理主题资源</a><ul class="toc-headings"><li><a href="#列出-topic">列出 topic</a></li><li><a href="#授权">授权</a></li><li><a href="#获取权限">获取权限</a></li><li><a href="#取消权限">取消权限</a></li><li><a href="#删除-topic">删除 topic</a></li><li><a href="#卸载-topic">卸载 topic</a></li><li><a href="#获取统计信息">获取统计信息</a></li><li><a href="#获取内部统计信息">获取内部统计信息</a></li><li><a href="#查看消息">查看消息</a></li><li><a href="#get-message-by-id">Get message by ID</a></li><li><a href="#检查消息">检查消息</a></li><li><a href="#按-id-获取消息">按 ID 获取消息</a></li><li><a href="#跳过消息">跳过消息</a></li><li><a href="#跳过所有消息">跳过所有消息</a></li><li><a href="#重置cursor">重置cursor</a></li><li><a href="#查询topic">查询topic</a></li><li><a href="#获取bundle">获取bundle</a></li><li><a href="#获取订阅">获取订阅</a></li><li><a href="#取消订阅">取消订阅</a></li><li><a href="#最后一条消息id">最后一条消息Id</a></li><li><a href="#配置去重快照间隔">配置去重快照间隔</a></li><li><a href="#configure-inactive-topic-policies">Configure inactive topic policies</a></li><li><a href="#configure-offload-policies">Configure offload policies</a></li></ul></li><li><a href="#管理非分区主题">管理非分区主题</a><ul class="toc-headings"><li><a href="#创建">创建</a></li><li><a href="#删除">删除</a></li><li><a href="#获取资源列表">获取资源列表</a></li><li><a href="#统计信息">统计信息</a></li></ul></li><li><a href="#管理分区主题">管理分区主题</a><ul class="toc-headings"><li><a href="#创建-1">创建</a></li><li><a href="#create-missed-partitions">Create missed partitions</a></li><li><a href="#获取元数据">获取元数据</a></li><li><a href="#更新">更新</a></li><li><a href="#删除-1">删除</a></li><li><a href="#获取资源列表-1">获取资源列表</a></li><li><a href="#统计信息-1">统计信息</a></li><li><a href="#internal-stats">Internal stats</a></li><li><a href="#获取-backlog-大小">获取 backlog 大小</a></li></ul></li><li><a href="#发布到分区主题">发布到分区主题</a><ul class="toc-headings"><li><a href="#routing-mode">Routing mode</a></li><li><a href="#custom-message-router">Custom message router</a></li><li><a href="#使用-key-时如何选择分区">使用 Key 时如何选择分区</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2022 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</section><span><script>
      const community = document.querySelector("a[href='#community']").parentNode;
      const communityMenu =
        '<li>' +
        '<a id="community-menu" href="#">Community <span style="font-size: 0.75em">&nbsp;▼</span></a>' +
        '<div id="community-dropdown" class="hide">' +
          '<ul id="community-dropdown-items">' +
            '<li><a href="/zh-CN/contact">Contact</a></li>' +
            '<li><a href="/zh-CN/contributing">Contributing</a></li>' +
            '<li><a href="/zh-CN/coding-guide">Coding guide</a></li>' +
            '<li><a href="/zh-CN/events">Events</a></li>' +
            '<li><a href="https://twitter.com/Apache_Pulsar" target="_blank">Twitter &#x2750</a></li>' +
            '<li><a href="https://github.com/apache/pulsar/wiki" target="_blank">Wiki &#x2750</a></li>' +
            '<li><a href="https://github.com/apache/pulsar/issues" target="_blank">Issue tracking &#x2750</a></li>' +
            '<li><a href="https://pulsar-summit.org/" target="_blank">Pulsar Summit &#x2750</a></li>' +
            '<li>&nbsp;</li>' +
            '<li><a href="/zh-CN/resources">Resources</a></li>' +
            '<li><a href="/zh-CN/team">Team</a></li>' +
            '<li><a href="/zh-CN/powered-by">Powered By</a></li>' +
          '</ul>' +
        '</div>' +
        '</li>';

      community.innerHTML = communityMenu;

      const communityMenuItem = document.getElementById("community-menu");
      const communityDropDown = document.getElementById("community-dropdown");
      communityMenuItem.addEventListener("click", function(event) {
        event.preventDefault();

        if (communityDropDown.className == 'hide') {
          communityDropDown.className = 'visible';
        } else {
          communityDropDown.className = 'hide';
        }
      });
    </script></span></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'd226a455cecdd4bc18a554c1b47e5b52',
                indexName: 'apache_pulsar',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:zh-CN","version:2.9.1"]}
              });
            </script></body></html>